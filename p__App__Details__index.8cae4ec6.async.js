"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[35],{32646:function(ln,de,n){n.d(de,{k:function(){return H}});var je=n(97857),ue=n.n(je),ge=n(90948),X=n(45843),ye=n(85893),H=(0,ge.ZP)(function(te){return(0,ye.jsx)(X.Z,ue()({focusVisibleClassName:".Mui-focusVisible",disableRipple:!0},te))})(function(te){var _=te.theme;return{width:42,height:26,padding:0,"& .MuiSwitch-switchBase":{padding:0,margin:2,transitionDuration:"300ms","&.Mui-checked":{transform:"translateX(16px)",color:"#fff","& + .MuiSwitch-track":{backgroundColor:_.palette.primary,opacity:1,border:0},"&.Mui-disabled + .MuiSwitch-track":{opacity:.5}},"&.Mui-focusVisible .MuiSwitch-thumb":{color:_.palette.primary,border:"6px solid #fff"},"&.Mui-disabled .MuiSwitch-thumb":{color:_.palette.mode==="light"?_.palette.grey[100]:_.palette.grey[600]},"&.Mui-disabled + .MuiSwitch-track":{opacity:_.palette.mode==="light"?.7:.3}},"& .MuiSwitch-thumb":{boxSizing:"border-box",width:22,height:22},"& .MuiSwitch-track":{borderRadius:26/2,backgroundColor:_.palette.mode==="light"?"#E9E9EA":"#39393D",opacity:1,transition:_.transitions.create(["background-color"],{duration:500})}}})},16961:function(ln,de,n){var je=n(52677),ue=n.n(je),ge=n(97857),X=n.n(ge),ye=n(19632),H=n.n(ye),te=n(5574),_=n.n(te),Ne=n(13769),a=n.n(Ne),Ce=n(44842),ce=n(22148),$e=n(40625),ke=n(42761),ze=n(90089),Je=n(93946),W=n(42293),He=n(10155),Ae=n(78462),Fe=n(97212),le=n(59334),Q=n(15861),Y=n(83321),Be=n(50657),ve=n(31425),D=n(50480),be=n(75438),Te=n(36872),Qe=n(72890),Ge=n(93109),ee=n(67294),g=n(85893),Xe=["defaultValue"],Ye=(0,ee.forwardRef)(function($,T){var R=$.defaultValue,k=a()($,Xe),Ze=ee.useState(!1),Re=_()(Ze,2),we=Re[0],he=Re[1],qe=(0,ee.useState)(R),Le=_()(qe,2),We=Le[0],O=Le[1],en=(0,ee.useState)(""),F=_()(en,2),nn=F[0],e=F[1],Ee=(0,Ge.Z)(nn,{wait:100}),on=(0,ce.useModel)("@@initialState"),M=on.initialState,ne=[{id:"extra_data_key",name:"\u975E\u8BA2\u9605\u6570\u636E",_id:"extra_data_key@local",keys:(M==null?void 0:M.boxdata.usercfgs.gist_cache_key)||[],descs_html:[],author:"local",repo:"",icons:[]}].concat(H()(((M==null?void 0:M.boxdata.sysapps)||[]).filter(function(h){return h.keys&&!!h.keys.length})));Object.values((M==null?void 0:M.boxdata.appSubCaches)||{}).forEach(function(h){ne=[].concat(H()(ne),H()(h.apps.filter(function(S){return S.keys&&!!S.keys.length})))}),ne=ne.filter(function(h){return h.name.indexOf(Ee)>-1||!Ee?!0:!!h.keys.find(function(S){return S.indexOf(Ee)>-1})});var B=M==null?void 0:M.boxdata.datas;(0,ee.useImperativeHandle)(T,function(){return{value:We}}),(0,ee.useEffect)(function(){O(k.value)},[k.value]);var _e=function(){he(!1),e("")},Ke=function(S){var z;O(S),(z=k.onChange)===null||z===void 0||z.call(k,{target:{name:k.name,value:S}})};return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(ze.Z,X()(X()({},k),{},{value:We,onChange:function(S){Ke(S.target.value)},size:"small",type:"text",endAdornment:(0,g.jsx)(Je.Z,{size:"small","aria-label":k.name,onClick:function(){he(!0)},children:(0,g.jsx)($e.Z,{fontSize:"small",sx:{color:function(S){return S.palette.primary.main}}})})})),(0,g.jsxs)(Be.Z,{open:we,onClose:function(){return _e()},sx:{mt:15,mb:15,"& .MuiDialog-paper":{width:"100%"}},children:[(0,g.jsx)(W.Z,{position:"static",sx:{background:function(S){return S.palette.primary.main}},children:(0,g.jsx)(He.Z,{children:(0,g.jsxs)(Ce.ol,{children:[(0,g.jsx)(Ce.el,{placeholder:"\u8BF7\u8F93\u5165\u5E94\u7528\u540D\u79F0\u6216\u7F13\u5B58Key",inputProps:{"aria-label":"search"},onChange:function(S){e(S.target.value)}}),(0,g.jsx)(Ce.cB,{children:(0,g.jsx)(ke.Z,{})})]})})}),(0,g.jsx)(Ae.Z,{subheader:(0,g.jsx)("li",{}),sx:{position:"relative",overflow:"auto",minHeight:300,"& ul":{padding:0}},children:(0,g.jsx)(Qe.Z,{name:"radio-buttons-group",onChange:function(S,z){Ke(z)},children:ne.length>0?ne.map(function(h,S){var z,Se,Me="".concat(h.id,"_").concat(h.author,"_").concat(S);return(0,g.jsxs)("li",{style:{width:"100%",boxSizing:"border-box"},children:[(0,g.jsxs)(be.Z,{sx:{borderBottom:"1px solid rgba(0, 0, 0, .125)",mt:0},children:[h==null?void 0:h.name,"\uFF08",h==null||(z=h.keys)===null||z===void 0?void 0:z.length,"\uFF09"]}),h==null||(Se=h.keys)===null||Se===void 0?void 0:Se.map(function(w){return(0,g.jsx)(Fe.ZP,{sx:{p:0,pl:3,pr:3},children:(0,g.jsx)(le.Z,{id:Me,primary:(0,g.jsx)(D.Z,{value:w,control:(0,g.jsx)(Te.Z,{}),label:w,sx:{"& .MuiFormControlLabel-label":{width:"80%",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"noWrap"}}}),primaryTypographyProps:{noWrap:!0,variant:"caption",sx:{fontWeight:"bold"}},secondary:(0,g.jsx)(Q.Z,{noWrap:!0,color:"grey",variant:"caption",component:"div",children:(ue()(B==null?void 0:B[w])==="object"&&(B!=null&&B[w])?JSON.stringify(B==null?void 0:B[w]):B==null?void 0:B[w])||"\u65E0\u6570\u636E"})})},"".concat(Me,"-").concat(w))})]},"section-".concat(Me))}):(0,g.jsx)(Fe.ZP,{sx:{height:290,textAlign:"center"},children:(0,g.jsx)(le.Z,{primary:"\u672A\u627E\u5230\u76F8\u5173\u7ED3\u679C"})})})}),(0,g.jsxs)(ve.Z,{sx:{borderTop:"1px solid rgba(0, 0, 0, .125)"},children:[(0,g.jsx)(Y.Z,{color:"inherit",onClick:function(){return _e()},children:"\u53D6\u6D88"}),(0,g.jsx)(Y.Z,{onClick:function(){return _e()},autoFocus:!0,children:"\u786E\u5B9A"})]})]})]})});de.Z=Ye},36208:function(ln,de,n){n.r(de),n.d(de,{default:function(){return Dn}});var je=n(9783),ue=n.n(je),ge=n(19632),X=n.n(ge),ye=n(52677),H=n.n(ye),te=n(5574),_=n.n(te),Ne=n(97857),a=n.n(Ne),Ce=n(13769),ce=n.n(Ce),$e=n(49677),ke=n.n($e),ze=n(32646),Je=n(16961),W=n(22148),He=n(60181),Ae=n(23508),Fe=n(74423),le=n(56815),Q=n(94054),Y=n(47312),Be=n(90089),ve=n(50135),D=n(51233),be=n(50480),Te=n(40476),Qe=n(69368),Ge=n(72890),ee=n(36872),g=n(10315),Xe=n(18972),Ye=n(58826),$=n(87357),T=n(15861),R=n(83321),k=n(82280),Ze=n(38895),Re=n(22797),we=n(20640),he=n.n(we),qe=n(96486),Le=n.n(qe),We=n(97458),O=n(67294),en=n(30780),F=n(87536),nn={add:"add___mHDQy",picker:"picker___ZxyLG"},e=n(85893),Ee=["text"],on=["id"];function M(j){var o=j.text,f=ce()(j,Ee),b=(0,Fe.Z)()||{},l=b.focused,c=O.useMemo(function(){return l?o:""},[l]);return(0,e.jsx)(We.Z,{type:["top","bottom"],leaveReverse:!0,style:{minHeight:25},children:l?(0,e.jsx)(le.Z,a()(a()({},f),{},{children:c}),o):null})}var ne=(0,O.forwardRef)(function(j,o){var f=j.value,b=j.defaultValue,l=j.name,c=j.onChange,s=(0,O.useState)(b),t=_()(s,2),i=t[0],m=t[1],y={};return y.color=i,(0,O.useImperativeHandle)(o,function(){return{value:f}}),(0,O.useEffect)(function(){m(f)},[f]),(0,e.jsx)(en.AI,a()(a()({},y),{},{className:nn.picker,onChangeComplete:function(E){m(E.hex),c==null||c({target:{name:l,value:E.hex}})}}))}),B=function(o,f){o.name=(o.disabled?"\u{1F232} \u624B\u52A8\u586B\u5199-":"")+o.name;var b=o.id.replaceAll(".","~"),l={name:o.formName||b,control:f==null?void 0:f.control,rules:{pattern:o.pattern}};return(0,e.jsxs)(e.Fragment,{children:[(["text","number"].includes(o.type)||!o.type)&&(0,e.jsxs)(Q.Z,{size:"small",sx:{width:1},variant:"standard",children:[(0,e.jsx)(Y.Z,{htmlFor:o.id,children:o.name}),(0,e.jsx)(F.Qr,a()(a()({},l),{},{render:function(s){var t=s.field,i=s.formState;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Be.Z,a()({id:o.id,size:"small",type:o.type,disabled:o.disabled,placeholder:o.placeholder},t)),(0,e.jsx)(M,{text:o.desc,error:!!i.errors[t.name]})]})}}))]}),o.type==="textarea"&&!o.child&&(0,e.jsx)(F.Qr,a()(a()({},l),{},{render:function(s){var t=s.field,i=s.formState;return(0,e.jsx)(ve.Z,a()({fullWidth:!0,multiline:!0,id:o.id,size:"small",label:o.name,variant:"standard",rows:6,helperText:o.desc,disabled:o.disabled,placeholder:o.placeholder,error:!!i.errors[t.name]},t))}})),o.child&&(0,e.jsxs)(Q.Z,{size:"small",sx:{width:1},variant:"standard",children:[(0,e.jsx)(Y.Z,{htmlFor:o.id,sx:{position:"unset",transform:"unset",mb:2},children:o.name}),(0,e.jsx)(_e,{name:l.name,form:f,setting:o}),(0,e.jsx)(M,{text:o.desc})]}),o.type==="boolean"&&(0,e.jsxs)(D.Z,{children:[(0,e.jsx)(F.Qr,a()(a()({},l),{},{render:function(s){var t=s.field;return(0,e.jsx)(be.Z,{label:o.name,control:(0,e.jsx)(ze.k,{sx:{m:1},disabled:o.disabled,checked:t.value==="true"||t.value===!0,onChange:function(m){return t.onChange(m.target.checked)}})})}})),(0,e.jsx)(le.Z,{sx:{minHeight:20},children:o.desc})]}),o.type==="checkboxes"&&(0,e.jsxs)(Q.Z,{component:"fieldset",variant:"standard",children:[(0,e.jsx)(Te.Z,{component:"legend",children:o.name}),(0,e.jsx)(F.Qr,a()(a()({},l),{},{render:function(s){var t,i=s.field,m=typeof i.value=="string",y=(m?i.value.split(","):i.value)||[];return(0,e.jsx)(e.Fragment,{children:(t=o.items)===null||t===void 0?void 0:t.map(function(p){return(0,e.jsx)(be.Z,{control:(0,e.jsx)(Qe.Z,{checked:y==null?void 0:y.includes(p.key),onChange:function(d){var I=y;d.target.checked?I.push(p.key):I=I.filter(function(L){return L!=p.key}),i.onChange(m?I.join(","):I)}}),label:p.label,disabled:o.disabled},p.key)})})}})),(0,e.jsx)(le.Z,{sx:{minHeight:20},children:o.desc})]}),["cacheKey","text","textarea","selects","boolean","radios","checkboxes","colorpicker","number"].indexOf(o.type)===-1&&(0,e.jsxs)(Q.Z,{size:"small",sx:{width:1},variant:"standard",children:[(0,e.jsx)(Y.Z,{htmlFor:o.id,children:o.name}),(0,e.jsx)(F.Qr,a()(a()({},l),{},{render:function(s){var t=s.field,i=s.formState;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Be.Z,a()({id:o.id,size:"small",type:o.type,disabled:o.disabled,placeholder:o.placeholder},t)),(0,e.jsx)(M,{text:o.desc,error:!!i.errors[t.name]})]})}}))]}),o.type==="radios"&&(0,e.jsxs)(Q.Z,{component:"fieldset",variant:"standard",children:[(0,e.jsx)(Te.Z,{component:"legend",children:o.name}),(0,e.jsx)(F.Qr,a()(a()({},l),{},{render:function(s){var t,i=s.field;return(0,e.jsx)(Ge.Z,a()(a()({},i),{},{children:(t=o.items)===null||t===void 0?void 0:t.map(function(m){return(0,e.jsx)(be.Z,{value:m.key,label:m.label,control:(0,e.jsx)(ee.Z,{}),disabled:o.disabled},m.key)})}))}})),(0,e.jsx)(le.Z,{sx:{minHeight:20},children:o.desc})]}),o.type==="selects"&&(0,e.jsxs)(Q.Z,{sx:{m:1},variant:"standard",children:[(0,e.jsx)(Y.Z,{htmlFor:o.id,children:o.name}),(0,e.jsx)(F.Qr,a()(a()({},l),{},{render:function(s){var t,i=s.field;return(0,e.jsx)(g.Z,a()(a()({placeholder:"\u8BF7\u9009\u62E9",sx:{width:"100%"},MenuProps:{sx:{maxHeight:300}}},i),{},{children:(t=o.items)===null||t===void 0?void 0:t.map(function(m,y){return(0,e.jsx)(Xe.Z,{value:m.key,children:m.label},"".concat(m.key,"_").concat(y))})}))}})),(0,e.jsx)(M,{text:o.desc})]}),o.type==="cacheKey"&&(0,e.jsx)(Q.Z,{size:"small",sx:{width:1},variant:"standard",children:(0,e.jsx)(F.Qr,a()(a()({},l),{},{render:function(s){var t=s.field,i=s.formState;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Y.Z,{htmlFor:o.id,shrink:!!t.value,children:o.name}),(0,e.jsx)(Je.Z,a()({},t)),(0,e.jsx)(M,{text:o.desc,error:!!i.errors[t.name]})]})}}))}),o.type==="colorpicker"&&(0,e.jsxs)(Q.Z,{size:"small",sx:{width:1},variant:"standard",children:[(0,e.jsx)(Y.Z,{htmlFor:o.id,sx:{position:"unset",transform:"unset",mb:2},children:o.name}),(0,e.jsx)(F.Qr,a()(a()({},l),{},{render:function(s){var t=s.field;return(0,e.jsx)(ne,{value:t.value,onChange:function(m){return t.onChange(m.target.value)}})}})),(0,e.jsx)(M,{text:o.desc})]})]})},_e=function(o){var f,b,l=o.setting,c=o.form,s=o.name,t=(0,F.Dq)({name:s,control:c==null?void 0:c.control}),i=t.fields,m=t.append,y=t.remove,p=(0,F.cI)(),E=(0,W.useModel)("alert"),d=(0,O.useState)(""),I=_()(d,2),L=I[0],J=I[1],De=(0,O.useState)(!1),K=_()(De,2),ae=K[0],Ve=K[1],ie=(0,O.useState)(!1),se=_()(ie,2),Oe=se[0],me=se[1],q=(0,O.useState)(!1),u=_()(q,2),Z=u[0],oe=u[1],U=function(x){return function(A,V){me(V?x:!1)}},re=0,G=[];i.forEach(function(C){var x=C.id,A=ce()(C,on),V=Object.keys(A),N=V.length;N>re&&(re=N,G=V)});var xe={};G=[].concat(X()(G),X()((l==null||(f=l.child)===null||f===void 0?void 0:f.map(function(C){return xe[C.id]=C,C.id}))||[])),G=Le().uniq(G);var Ie=i.filter(function(C,x){return ae?!0:x<4}),fe=function(){oe(!1),p.reset()};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(Ye.ZP,{anchor:"bottom",open:Z,onClose:function(){return fe()},children:[(0,e.jsx)($.Z,{sx:{pt:1,pb:1,borderBottom:1,borderColor:"divider",boxShadow:function(x){return x.shadows[2]},position:"fixed",width:"100%",bgcolor:"inherit",zIndex:99},children:(0,e.jsxs)(D.Z,{direction:"row",alignItems:"center",children:[(0,e.jsxs)(T.Z,{sx:{flexGrow:1,pl:1},children:[L,"-",l==null?void 0:l.name]}),(0,e.jsx)(R.Z,{color:"primary",onClick:function(){var x=p.getValues();if(x["*JSON*"])try{return c==null||c.setValue(s,JSON.parse(x["*JSON*"])),fe()}catch(A){return E.alert({open:!0,message:"JSON \u683C\u5F0F\u9519\u8BEF",type:"error"})}Object.keys(x).forEach(function(A){x[A]===void 0&&(x[A]="")}),m(x),fe()},children:"\u4FDD\u5B58"})]})}),(0,e.jsx)(D.Z,{sx:{pt:10,pl:2,pr:2,height:"60vh",maxHeight:"60vh"},children:G&&L==="\u65B0\u589E"?(b=G)===null||b===void 0?void 0:b.map(function(C,x){var A=xe[C]||{id:"[".concat(x,"].").concat(C),name:C,type:"text"};return(0,e.jsx)(O.Fragment,{children:B(A,p)},A.id)}):(0,e.jsx)(ve.Z,a()({fullWidth:!0,multiline:!0,size:"small",minRows:10,variant:"standard",placeholder:"\u8BF7\u8F93\u5165 JSON \u6570\u7EC4",helperText:(0,e.jsx)("pre",{children:` JSON \u683C\u5F0F\u6570\u7EC4\u793A\u4F8B\u503C
`.concat(JSON.stringify([{key:1,val:1},{key:2,val:2}],null," "))})},p.register("*JSON*")))})]}),Ie.map(function(C,x){var A,V=l!=null&&l.primary?l==null?void 0:l.primary.map(function(r){return C[r]||x+1}):[l==null?void 0:l.name,x+1],N="".concat(l==null?void 0:l.id,"-").concat(x);return!ae&&x>4?null:(0,e.jsxs)(k.Z,{expanded:Oe===N,onChange:U(N),children:[(0,e.jsx)(Ze.Z,{id:N,expandIcon:(0,e.jsx)(Ae.Z,{}),"aria-controls":"".concat(N,"-content"),children:(0,e.jsx)(T.Z,{variant:"body2",children:V==null?void 0:V.join("-")})}),(0,e.jsxs)(Re.Z,{children:[Oe===N&&((A=G)===null||A===void 0?void 0:A.map(function(r){var v=xe[r]||{type:"text",id:r,name:r};return(0,e.jsx)(O.Fragment,{children:B(a()(a()({},v),{},{formName:"".concat(s,".").concat(x,".").concat(r)}),c)},v.id)})),(0,e.jsx)(R.Z,{size:"small",color:"error",sx:{width:"100%"},variant:"contained",onClick:function(){y(x),me(!1)},children:"\u5220\u9664"})]})]},N)}),i.length>5&&(0,e.jsx)(k.Z,{expanded:!1,onClick:function(){Ve(!ae)},children:(0,e.jsx)(Ze.Z,{children:(0,e.jsx)(T.Z,{color:"primary",variant:"body2",sx:{width:1,display:"flex",alignItems:"center",justifyContent:"center"},children:ae?(0,e.jsxs)(e.Fragment,{children:["\u6536\u8D77 ",(0,e.jsx)(He.Z,{})]}):(0,e.jsxs)(e.Fragment,{children:["\u66F4\u591A ",(0,e.jsx)(Ae.Z,{})]})})})}),(0,e.jsx)(k.Z,{expanded:!1,children:(0,e.jsx)(Ze.Z,{children:(0,e.jsxs)(D.Z,{spacing:1,sx:{width:1},direction:"row",alignItems:"center",justifyContent:"center",children:[(0,e.jsx)(R.Z,{color:"error",onClick:function(){c==null||c.setValue(s,[])},children:"\u6E05\u7A7A"}),(0,e.jsx)(R.Z,{color:"primary",onClick:function(){p.reset(),J("\u65B0\u589E"),oe(!0)},children:"\u65B0\u589E"}),(0,e.jsx)(R.Z,{color:"warning",onClick:function(){he()(JSON.stringify(i)),E.alert({open:!0,message:"\u590D\u5236\u6210\u529F",type:"success"})},children:"\u590D\u5236"}),(0,e.jsx)(R.Z,{color:"info",onClick:function(){p.reset(),J("\u5BFC\u5165"),oe(!0)},children:"\u5BFC\u5165"})]})})})]})};function Ke(j){var o=j.form,f=j.setting;return f?B(a()({},f),o):null}var h=Ke,S=n(92461),z=n(67720),Se=function(o){var f=o.formConfig,b=(0,W.useModel)("@@initialState"),l=b.initialState,c=(0,W.useModel)("api"),s=c.fetchSave,t={},i=function(){f.forEach(function(p){var E=l==null?void 0:l.boxdata.datas[p.id],d=E===""||E===void 0?p.val:E;d===null&&(d=void 0);try{t[p.id.replaceAll(".","~")]=p.child?JSON.parse("".concat(d||[])):d}catch(I){console.log(I)}})};i();var m=(0,F.cI)({defaultValues:t});return(0,O.useEffect)(function(){t={},i(),m.reset(t)},[l==null?void 0:l.boxdata]),(0,e.jsxs)(S.Z,{form:m,noValidate:!0,onSubmit:function(p){var E=[];Object.keys(p).forEach(function(d){var I=d.replaceAll("~","."),L=l==null?void 0:l.boxdata.datas[I],J=p[d];if(H()(J)==="object"&&typeof L=="string")try{J=JSON.stringify(J,null," ")}catch(De){J=p[d].join(",")}else typeof p[d]=="boolean"&&(J="".concat(p[d]));E.push({key:I,val:J})}),s.run(E)},autoComplete:"off",children:[(0,e.jsx)(D.Z,{sx:{pl:2,pr:2},spacing:1,children:f.map(function(y){return(0,e.jsx)(h,{form:m,setting:y,itemValue:l==null?void 0:l.boxdata.datas},y.id)})}),(0,e.jsx)(z.Z,{}),(0,e.jsx)(D.Z,{p:"5px",spacing:2,justifyContent:"flex-end",children:(0,e.jsx)(R.Z,{type:"submit",variant:"text",sx:{width:"max-content",marginLeft:"auto"},children:"\u4FDD\u5B58"})})]})},Me=Se,w=n(31085),hn=["appName"],mn=function(o){var f,b,l=(0,W.useModel)("api"),c=l.fetchSave,s=(0,F.cI)();return(0,O.useEffect)(function(){if(o.open){var t,i,m={};(t=o.data)===null||t===void 0||t.datas.forEach(function(y){m[y.key.replace(".","*")]=H()(y.val)==="object"?JSON.stringify(y.val):y.val}),s.reset(a()({appName:(i=o.data)===null||i===void 0?void 0:i.name},m))}},[o.open]),(0,e.jsx)(w.Z,{fullScreen:!0,open:!!o.open,title:"".concat(((f=o.data)===null||f===void 0?void 0:f.name)||"\u4F1A\u8BDD\u4FEE\u6539"),onClose:function(){var i;(i=o.onClose)===null||i===void 0||i.call(o)},form:s,loading:c.loading,onSubmit:function(i){var m=i.appName,y=ce()(i,hn),p=[];Object.keys(y).forEach(function(E){p.push({key:E.replace("*","."),val:y[E]})}),c.run([{key:"@chavy_boxjs_sessions.".concat(o.sessionIndex),val:a()(a()({},o.data),{},{datas:p,name:m})}]).then(function(){var E;(E=o.onClose)===null||E===void 0||E.call(o)})},children:(0,e.jsxs)(D.Z,{spacing:2,children:[(0,e.jsx)(ve.Z,a()({fullWidth:!0,size:"small",label:"\u4F1A\u8BDD\u540D\u79F0",variant:"standard",placeholder:"\u4F1A\u8BDD\u540D\u79F0",InputLabelProps:{shrink:!0}},s.register("appName"))),(b=o.data)===null||b===void 0?void 0:b.datas.map(function(t){return(0,e.jsx)(ve.Z,a()({fullWidth:!0,size:"small",label:t.key,variant:"standard",placeholder:"\u8BF7\u8F93\u5165",InputLabelProps:{shrink:!0}},s.register(t.key.replace(".","*"))),t.key)})]})})},xn=mn,fn=n(5554),pn=n(84424),jn=n(50594),an=n(3018),gn=n(43329),sn=n(90948),yn=n(14948),Ue=n(93946),dn=n(98456),Pe=n(90629),rn=n(78462),tn=n(97212),un=n(59334),Cn=n(74815),bn=n(90852),Zn=n(40044),En=n(8379),cn=n.n(En),_n=["children","value","index"],vn=(0,sn.ZP)(yn.Z)(function(j){var o=j.theme;return{right:"unset","& .MuiBadge-badge":{transform:"scale(1) translate(2px, -50%)",color:o.palette.common.white}}}),Sn=(0,sn.ZP)(T.Z)(function(j){return ke()(j),{right:"unset",whiteSpace:"pre-wrap",wordBreak:"break-word","& h4,h1,h2,h3,p":{padding:0,margin:0}}});function Mn(j){var o=j.children,f=j.value,b=j.index,l=ce()(j,_n);return(0,e.jsx)("div",a()(a()({role:"tabpanel",hidden:f!==b,id:"simple-tabpanel-".concat(b),"aria-labelledby":"simple-tab-".concat(b)},l),{},{children:f===b&&(0,e.jsx)($.Z,{sx:{p:3},children:o})}))}function Pn(j){return{id:"simple-tab-".concat(j),"aria-controls":"simple-tabpanel-".concat(j)}}function Dn(){var j,o,f,b,l,c,s,t,i,m,y,p,E=(0,W.useModel)("@@initialState"),d=E.initialState,I=(0,W.useParams)(),L=I==null?void 0:I.id,J=(0,O.useState)(),De=_()(J,2),K=De[0],ae=De[1],Ve=(0,W.useModel)("api"),ie=Ve.fetchSave,se=Ve.fetchRunScript,Oe=(0,W.useModel)("alert"),me=d==null?void 0:d.boxdata.datas,q=(d==null?void 0:d.boxdata.sessions)||[],u=d==null?void 0:d.apps.find(function(r){return r.id===L}),Z=q==null?void 0:q.filter(function(r){return(r==null?void 0:r.appId)==="".concat(L)}),oe=!1,U={id:cn()(),appId:L,enable:!0,appName:u==null?void 0:u.name,createTime:new Date,datas:u==null?void 0:u.keys.map(function(r){return{key:r,val:me==null?void 0:me[r]}})};Z&&!(Z!=null&&Z.length)&&u!==null&&u!==void 0&&u.keys&&L&&(oe=!0);var re=(Z==null?void 0:Z.findIndex(function(r){return(r==null?void 0:r.id)===(d==null?void 0:d.boxdata.curSessions["".concat(L)])}))||0;re>-1&&(U.name=Z==null?void 0:Z[re].name);var G=O.useState(re>-1?re:0),xe=_()(G,2),Ie=xe[0],fe=xe[1],C=function(v){fe(v)},x=Z[Ie],A={};x==null||x.datas.forEach(function(r){A[r.key]=r.val});var V=d==null?void 0:d.boxdata.usercfgs,N=q==null?void 0:q.findIndex(function(r){return(r==null?void 0:r.id)===(x==null?void 0:x.id)});return u?(0,e.jsxs)(D.Z,{spacing:1,p:1,children:[(0,e.jsx)(xn,{data:K==null||(j=K.update)===null||j===void 0?void 0:j.data,open:K==null||(o=K.update)===null||o===void 0?void 0:o.open,value:K==null||(f=K.update)===null||f===void 0?void 0:f.val,sessionIndex:N,onClose:function(){return ae(function(v){if(v)return v.update={open:!1},a()({},v)})}}),(0,e.jsxs)(D.Z,{direction:"row",justifyContent:u.script?"space-between":"flex-start",alignItems:"center",children:[(0,e.jsx)(T.Z,{variant:"h6",p:2,component:"span",sx:(0,fn.V$)(V==null?void 0:V.bgimg),onClick:function(){var v,P,pe=u.script||((v=u.scripts)===null||v===void 0||(P=v[0])===null||P===void 0?void 0:P.script)||"";pe&&W.history.push("/code",{url:pe})},children:u.name}),u.script&&(0,e.jsx)($.Z,{sx:{position:"relative"},children:(0,e.jsxs)(Ue.Z,{edge:"end","aria-label":u.name,sx:{mr:.5},onClick:function(){u.script&&se.run({url:u.script,isRemote:!0})},children:[(0,e.jsx)(an.Z,{color:"primary"}),((b=se.fetches[u.script])===null||b===void 0?void 0:b.loading)&&(0,e.jsx)(dn.Z,{size:24,sx:{position:"absolute",top:"50%",left:"50%",marginTop:"-12px",marginLeft:"-12px"}})]})})]}),((l=u.descs_html)===null||l===void 0?void 0:l.length)&&(0,e.jsx)(Pe.Z,{sx:{padding:2,mb:2},elevation:3,children:u.descs_html.map(function(r,v){return(0,e.jsx)(Sn,{color:"grey",display:"block",variant:"caption",sx:{mb:0},dangerouslySetInnerHTML:{__html:r}},"html-".concat(v))})},"html"),((c=u.scripts)===null||c===void 0?void 0:c.length)&&(0,e.jsx)(Pe.Z,{sx:{padding:2,mb:2},elevation:3,children:(0,e.jsxs)(D.Z,{spacing:2,children:[(0,e.jsxs)(D.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,e.jsx)(T.Z,{variant:"body2",children:"\u5E94\u7528\u811A\u672C"}),(0,e.jsx)(vn,{color:"primary",badgeContent:(s=u.scripts)===null||s===void 0?void 0:s.length,sx:{color:function(v){return v.palette.common.white}}})]}),(0,e.jsx)(rn.Z,{disablePadding:!0,children:u.scripts.map(function(r,v){var P;return(0,e.jsx)(tn.ZP,{sx:{padding:0,mb:2},secondaryAction:(0,e.jsxs)(Ue.Z,{edge:"end",sx:{mr:-3.5,position:"relative"},"aria-label":r.name,onClick:function(){se.run({url:r.script,isRemote:!0})},children:[(0,e.jsx)(an.Z,{}),((P=se.fetches[r.script])===null||P===void 0?void 0:P.loading)&&(0,e.jsx)(dn.Z,{size:24,sx:{position:"absolute",top:"50%",left:"50%",marginTop:"-12px",marginLeft:"-12px"}})]}),children:(0,e.jsx)(T.Z,{variant:"body2",sx:{fontWeight:500},component:"span",onClick:function(){W.history.push("/code",{url:r.script})},children:"".concat(v+1,".").concat(r.name)})},r.name)})})]})},"scripts"),((t=u.settings)===null||t===void 0?void 0:t.length)&&(0,e.jsx)(Pe.Z,{sx:{mb:2},elevation:3,children:(0,e.jsxs)(D.Z,{spacing:2,children:[(0,e.jsxs)(D.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",p:2,children:[(0,e.jsx)(T.Z,{variant:"body2",children:"\u5E94\u7528\u8BBE\u7F6E"}),(0,e.jsx)(vn,{color:"primary",badgeContent:(i=u.settings)===null||i===void 0?void 0:i.length,sx:{color:function(v){return v.palette.common.white}}})]}),(m=ie.fetches.chavy_boxjs_cur_sessions)!==null&&m!==void 0&&m.loading?null:(0,e.jsx)(Me,{formConfig:u.settings})]})},"setting"),(u==null||(y=u.keys)===null||y===void 0?void 0:y.length)!==0?(0,e.jsxs)(Pe.Z,{elevation:3,sx:{mb:2},children:[(0,e.jsx)($.Z,{sx:{borderBottom:1,borderColor:"divider",px:2,py:1},children:(0,e.jsxs)(D.Z,{direction:"row",spacing:2,children:[(0,e.jsx)(T.Z,{children:"\u5F53\u524D\u4F1A\u8BDD"}),U.name?(0,e.jsxs)(T.Z,{color:"primary",children:["#",U.name]}):null]})}),(0,e.jsx)($.Z,{sx:{p:2},children:(0,e.jsx)(rn.Z,{disablePadding:!0,children:U==null?void 0:U.datas.map(function(r){return(0,e.jsxs)(tn.ZP,{sx:{p:0},children:[(0,e.jsx)(un.Z,{primary:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{style:{maxWidth:"85%",display:"inline-block",textOverflow:"ellipsis",overflow:"hidden",height:"100%",verticalAlign:"middle"},children:r.key}),r.val&&(0,e.jsx)(Ue.Z,{onClick:function(){he()(r.val),Oe.alert({open:!0,message:"\u590D\u5236\u6210\u529F",type:"success"})},children:(0,e.jsx)(pn.Z,{fontSize:"small"})})]}),primaryTypographyProps:{noWrap:!0,variant:"caption",sx:{fontWeight:"bold"}},secondary:(0,e.jsx)(T.Z,{noWrap:!0,color:"grey",variant:"caption",component:"div",children:(H()(r.val)==="object"&&r.val?JSON.stringify(r.val):r.val)||"\u65E0\u6570\u636E"})}),(0,e.jsx)(Ue.Z,{onClick:function(){var P=X()((U==null?void 0:U.datas)||[]),pe=P.findIndex(function(On){return On.key===r.key});P[pe].val="",ie.run(P)},children:(0,e.jsx)(jn.Z,{fontSize:"small"})})]},r.key)})})}),(0,e.jsx)($.Z,{p:1,sx:{borderTop:1,borderColor:"divider",display:"flex",justifyContent:"flex-end"},children:(0,e.jsx)(R.Z,{color:"error",onClick:function(){if(Z){var v=a()({},U);oe?v.name="\u4F1A\u8BDD 1":v.name="\u4F1A\u8BDD ".concat(Z.length+1),v.id=cn()(),d&&ie.run([{key:"@chavy_boxjs_sessions.".concat(q.length),val:a()({},v)}])}},children:"\u514B\u9686"})})]},"curSessionItem"):(0,e.jsx)(e.Fragment,{}),(Z==null?void 0:Z.length)!==0&&(u==null||(p=u.keys)===null||p===void 0?void 0:p.length)!==0?(0,e.jsxs)(Pe.Z,{elevation:3,children:[(0,e.jsx)($.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,e.jsx)(Cn.Z,{value:Ie,scrollButtons:!0,variant:"scrollable",allowScrollButtonsMobile:!0,"aria-label":"scrollable force tabs example",sx:ue()({},"& .".concat(bn.Z.scrollButtons),{"&.Mui-disabled":{opacity:.3}}),onChange:function(v,P){return C(P)},children:Z==null?void 0:Z.map(function(r,v){return(0,e.jsx)(Zn.Z,a()({label:(0,e.jsxs)(D.Z,{spacing:1,direction:"row",alignItems:"center",children:[re===v?(0,e.jsx)(gn.Z,{sx:{width:16,height:16}}):null,(0,e.jsxs)(T.Z,{children:[oe?"":"".concat(v+1," # "),r.name]})]})},Pn(v)),r.id)})})}),Z==null?void 0:Z.map(function(r,v){return(0,e.jsx)(Mn,{value:v,index:Ie,children:(0,e.jsx)(rn.Z,{disablePadding:!0,children:r==null?void 0:r.datas.map(function(P){return(0,e.jsx)(tn.ZP,{sx:{p:0},children:(0,e.jsx)(un.Z,{primary:"".concat(P.key),primaryTypographyProps:{variant:"caption",sx:{fontWeight:"bold"}},secondary:(0,e.jsx)(T.Z,{color:"grey",variant:"caption",noWrap:!0,component:"div",children:(H()(P.val)==="object"?JSON.stringify(P.val):P.val)||"\u65E0\u6570\u636E"})})},P.key)})})},r.id)}),(0,e.jsx)($.Z,{p:1,sx:{borderTop:1,borderColor:"divider"},children:(0,e.jsxs)(D.Z,{direction:"row",alignItems:"center",justifyContent:"flex-end",children:[!oe&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(R.Z,{color:"error",onClick:function(){d&&ie.run([{key:"@chavy_boxjs_sessions.".concat(N),val:null}]).then(function(){fe(0)})},children:"\u5220\u9664"}),(0,e.jsx)(R.Z,{color:"warning",onClick:function(){ae({update:{open:!0,data:x,val:A}})},children:"\u4FEE\u6539"}),(0,e.jsx)(R.Z,{color:"primary",onClick:function(){!d||!L||ie.run([{key:"chavy_boxjs_cur_sessions",val:JSON.stringify(a()(a()({},d==null?void 0:d.boxdata.curSessions),{},ue()({},L,x.id)))}].concat(X()(x.datas)))},children:"\u5E94\u7528"})]}),(0,e.jsx)(R.Z,{color:"success",onClick:function(){he()(JSON.stringify(A)),Oe.alert({open:!0,message:"\u590D\u5236\u6210\u529F",type:"success"})},children:"\u590D\u5236"})]})})]}):(0,e.jsx)(e.Fragment,{})]}):"No find App"}}}]);
