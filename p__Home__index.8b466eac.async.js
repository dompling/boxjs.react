"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[371],{86587:function(z,j,n){n.r(j),n.d(j,{default:function(){return uo}});var G=n(5574),I=n.n(G),$=n(13769),F=n.n($),H=n(97857),y=n.n(H),J=n(58291),p=n(22148),N=n(90948),Q=n(90629),V=n(98396),R=n(51233),W=n(87357),B=n(69661),X=n(81458),Y=n(15861),k=n(7145),q=n.n(k),oo=n(97458),A=n(67294),io=n(98958),U=n(98169),no=n(63679),ao=n(36963),eo=n(9628),t=n(85893),to=["item","script","moveCard","findCard","data"],ro=(0,N.ZP)(Q.Z)(function(u){var e=u.theme;return y()(y()({},e.typography.body2),{},{textAlign:"center",color:e.palette.text.secondary,overflow:"hidden",background:"unset",boxShadow:"unset",borderRadius:0})}),h={},T={},so=function(e){var d,o=e.item,M=e.script,E=e.moveCard,C=e.findCard,O=e.data,S=F()(e,to),_=(0,V.Z)("(min-width:960px)"),v="".concat(o==null?void 0:o.id,"_").concat(o==null?void 0:o.author),P=(0,p.useModel)("@@initialState"),s=P.initialState,D=(0,p.useModel)("api"),i=D.fetchRunScript,l=D.fetchSave,r=C(v).index,m=(0,io.c)(function(){return{type:"grid",item:{id:v,originalIndex:r},collect:function(a){var f=a.getSourceClientOffset(),x={x:0,y:0};return f&&(x.x=f.x,x.y=f.y),{offset:x,isDragging:a.isDragging()}},end:function(a,f){var x=a.id,K=a.originalIndex,xo=f.didDrop();xo||E(x,K);var po=O==null?void 0:O.map(function(L){return L==null?void 0:L.id}),Eo=s==null?void 0:s.boxdata.usercfgs;l.run({key:J.Z.userCfgs,val:JSON.stringify(y()(y()({},Eo),{},{favapps:po}))})}}},[v,r,E]),c=I()(m,2),Z=c[0],w=Z.isDragging,b=Z.offset,vo=c[1],co=(0,U.L)(function(){return{accept:"grid",hover:function(a){var f=a.id;if(f!==v){var x=C(v),K=x.index;E(f,K)}}}},[C,E]),fo=I()(co,2),ho=fo[1],mo=w?0:1;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ro,{sx:{flex:_?"0 0 ".concat(100/6,"%"):"0 0 25%",opacity:mo,transform:"translate(0,0)",pt:1,pb:1},ref:function(a){return vo(ho(a))},onClick:function(){var a="".concat(o==null?void 0:o.id);h[a]===void 0&&(h[a]=0),h[a]+=1,T[a]=setTimeout(function(){if(T[a]!==void 0&&clearTimeout(T[a]),h[a]===2){if(h[a]=0,!M)return p.history.push("/app/".concat(a));i.run({url:M,isRemote:!0})}else h[a]===1&&p.history.push("/app/".concat(a));h={}},200)},children:(0,t.jsxs)(R.Z,{spacing:1,justifyContent:"center",alignItems:"center",children:[(0,t.jsxs)(W.Z,{sx:{width:56,height:56,borderRadius:3,overflow:"hidden",position:"relative",boxShadow:function(a){return a.shadows[5]}},children:[(0,t.jsx)(B.Z,{variant:"square",alt:o==null?void 0:o.name,src:o==null?void 0:o.icon,sx:{width:"100%",height:"100%"}}),((d=i.fetches["".concat(M)])===null||d===void 0?void 0:d.loading)&&(0,t.jsx)(X.Z,{sx:{position:"absolute",bottom:0,width:"100%"}})]}),(0,t.jsx)(Y.Z,{variant:"body2",sx:{fontSize:12,maxWidth:56,color:s!=null&&s.boxdata.usercfgs.bgimg?"#fff":"unset",width:"100%",fontWeight:"bold",textShadow:s!=null&&s.boxdata.usercfgs.bgimg?"black 0.1em 0.1em 0.2em":"unset"},noWrap:!0,children:o==null?void 0:o.name})]})},"".concat(o==null?void 0:o.id,"/").concat(o==null?void 0:o.author,"/").concat(o==null?void 0:o.name)),w&&(s==null?void 0:s.isMobile)&&(0,t.jsx)(R.Z,{sx:{zIndex:-1,opacity:.5,position:"fixed",left:b==null?void 0:b.x,top:b==null?void 0:b.y},spacing:1,justifyContent:"center",alignItems:"center",children:(0,t.jsx)(W.Z,{sx:{width:40,height:40,borderRadius:2,overflow:"hidden",position:"relative",boxShadow:function(a){return a.shadows[4]}},children:(0,t.jsx)(B.Z,{variant:"square",alt:o==null?void 0:o.name,src:o==null?void 0:o.icon,sx:{width:"100%",height:"100%"}})})})]})},_o=(0,A.memo)(so);function lo(){var u,e=(0,p.useModel)("@@initialState"),d=e.initialState,o=(0,U.L)(function(){return{accept:"grid"}}),M=I()(o,2),E=M[1],C=(d==null||(u=d.boxdata)===null||u===void 0?void 0:u.usercfgs.favapps.map(function(i){return d==null?void 0:d.apps.find(function(l){return l.id===i})}).filter(function(i){return!!i}))||[],O=(0,A.useState)(C),S=I()(O,2),_=S[0],v=S[1],P=(0,A.useCallback)(function(i){var l=_.filter(function(r){return"".concat(r==null?void 0:r.id,"_").concat(r==null?void 0:r.author)===i})[0];return{card:l,index:_.indexOf(l)}},[_]),s=(0,A.useCallback)(function(i,l){var r=P(i),m=r.card,c=r.index;v(q()(_,{$splice:[[c,1],[l,0,m]]}))},[P,_,v]),D=d==null?void 0:d.ui(d.boxdata);return(0,t.jsx)(R.Z,{ref:E,direction:"row",flexWrap:"wrap",children:_==null?void 0:_.map(function(i,l){var r;D==null||D.loadAppBaseInfo(i);var m=null;if(i!=null&&i.script)m=i==null?void 0:i.script;else if(i!=null&&i.scripts&&i!==null&&i!==void 0&&(r=i.scripts[0])!==null&&r!==void 0&&r.script){var c;m=i==null||(c=i.scripts[0])===null||c===void 0?void 0:c.script}return(0,t.jsx)(_o,{item:i,data:_,script:m,findCard:P,moveCard:s,index:l},"".concat(i==null?void 0:i.id,"-").concat(i==null?void 0:i.author))})})}function uo(){var u=(0,p.useModel)("@@initialState"),e=u.initialState;return(0,t.jsx)(oo.Z,{interval:[100,0],appear:!!(e!=null&&e.boxdata.usercfgs.isAnimate),children:(0,t.jsx)(W.Z,{pt:1,component:"div",children:(0,t.jsx)(no.W,{options:{delay:400},backend:e!=null&&e.isMobile?eo.zr:ao.PD,children:(0,t.jsx)(lo,{})})},"container")})}},58291:function(z,j){j.Z={logo:"https://raw.githubusercontent.com/Orz-3/mini/master/Color/box.png",userCfgs:"chavy_boxjs_userCfgs",sessions:"chavy_boxjs_sessions",app_subCaches:"chavy_boxjs_app_subCaches",backups:"chavy_boxjs_backups",cursessions:"chavy_boxjs_cur_sessions",gistCacheKey:"@chavy_boxjs_userCfgs.gist_cache_key",viewkeys:"@chavy_boxjs_userCfgs.viewkeys"}}}]);
