"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[875],{92461:function(po,S,e){var Q=e(97857),s=e.n(Q),k=e(13769),l=e.n(k),to=e(67294),x=e(85893),w=["onSubmit","form"],q=function(O){var o=O.onSubmit,y=O.form,U=l()(O,w);return(0,x.jsx)("form",s()(s()({onSubmit:(y==null?void 0:y.handleSubmit(o))||function(H){H.preventDefault(),o(void 0)}},U),{},{children:U.children}))};S.Z=q},31085:function(po,S,e){e.d(S,{Z:function(){return ao}});var Q=e(13769),s=e.n(Q),k=e(97857),l=e.n(k),to=e(92461),x=e(54776),w=e(50657),q=e(37645),c=e(87357),O=e(6514),o=e(31425),y=e(83321),U=e(47036),H=e(98456),io=e(67294),_={fullScreen:"fullScreen___mbcSL",header_container:"header_container___wE0ve"},u=e(85893),fo=["footer","loading","onClose","title","children","onSubmit","form"],mo=io.forwardRef(function(h,T){return(0,u.jsx)(x.Z,l()({direction:"up",ref:T},h))}),go=function(h){var T=h.footer,so=h.loading,Y=h.onClose,G=h.title,bo=h.children,oo=h.onSubmit,Zo=h.form,m=s()(h,fo);return(0,u.jsx)(w.Z,l()(l()({maxWidth:"xs",TransitionComponent:mo,sx:{"& .MuiDialog-paper":{minWidth:"80%"}},className:m.fullScreen?_.fullScreen:""},m),{},{children:m.open&&(0,u.jsxs)(to.Z,{form:Zo,onSubmit:function(eo){oo==null||oo(eo)},children:[G&&typeof G=="string"?(0,u.jsx)(q.Z,{className:_.header_container,sx:{fontSize:"1rem",padding:1.5},children:G},"title"):(0,u.jsx)(c.Z,{className:_.header_container,children:G}),(0,u.jsx)(O.Z,{dividers:!0,children:m.open?bo:null},"content"),(0,u.jsx)(o.Z,{children:T!==void 0?T:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(y.Z,{sx:{color:U.Z[600]},"aria-label":"delete",onClick:function(){Y==null||Y()},children:"\u53D6\u6D88"}),(0,u.jsx)(y.Z,{type:"submit",children:so?(0,u.jsx)(H.Z,{color:"inherit",size:20}):"\u786E\u5B9A"})]})},"action")]})}),"Dialog")},ao=go},85051:function(po,S,e){e.r(S),e.d(S,{default:function(){return wo}});var Q=e(97857),s=e.n(Q),k=e(5574),l=e.n(k),to=e(31085),x=e(22148),w=e(50135),q=e(56815),c=e(67294),O=e(87536),o=e(85893),y=function(i){var W=(0,x.useModel)("api"),Z=W.fetchAddAppSub,j=(0,O.cI)(),z=(0,x.useSearchParams)(),L=l()(z,1),M=L[0];return(0,c.useEffect)(function(){var n=M.get("add");n&&j.setValue("url",n)},[]),(0,o.jsxs)(to.Z,{title:"\u6DFB\u52A0\u8BA2\u9605",open:!!i.open,onClose:function(){i.onClose(),j.reset()},form:j,loading:Z.loading,onSubmit:function(A){A.url&&Z.run(A.url).then(i.onClose)},children:[(0,o.jsx)(w.Z,s()(s()({fullWidth:!0,multiline:!0,minRows:3,size:"small",variant:"standard",label:"\u8BA2\u9605\u5730\u5740",placeholder:"\u8BF7\u8F93\u5165\u8BA2\u9605\u5730\u5740"},j.register("url")),{},{InputLabelProps:{shrink:!0}})),(0,o.jsx)(q.Z,{sx:{wordWrap:"break-word"},children:"https://raw.githubusercontent.com/chavyleung/scripts/master/box/chavy.boxjs.json"})]})},U=y,H=e(5554),io=e(58291),_=e(41687),u=e(58853),fo=e(66385),mo=e(46907),go=e(25449),ao=e(1849),jo=e(11359),h=e(90948),T=e(14948),so=e(13486),Y=e(60265),G=e(50657),bo=e(37645),oo=e(6514),Zo=e(58951),m=e(87357),d=e(51233),eo=e(69661),Bo=e(98456),D=e(15861),lo=e(47036),$o=e(31425),Eo=e(83321),Oo=e(90629),P=e(93946),Ko=e(20640),Co=e.n(Ko),No=e(7145),Uo=e.n(No),Ho=e(97458),Yo=e(98958),To=e(98169),Go=e(63679),Jo=e(36963),Vo=e(9628),Wo={},So=(0,h.ZP)(T.Z)(function(g){var i=g.theme;return{"& .MuiBadge-badge":{bottom:"30%",boxShadow:"0 0 0 2px ".concat(i.palette.background.paper),"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"& .MuiBadge-colorSuccess":{color:so.Z[700],background:so.Z[700]},"& .MuiBadge-colorError":{color:Y.Z[700],background:Y.Z[700]},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(1.4)",opacity:0}}}}),zo=(0,h.ZP)(T.Z)(function(){return{"& .MuiBadge-badge":{color:"#fff"}}}),Xo=function(i){var W,Z,j,z,L,M,n=i.appItem,A=i.index,co=i.findCard,a=i.moveCard,uo=i.data,yo=i.setCards,I=(0,c.useRef)(null),Do=(0,x.useModel)("@@initialState"),p=Do.initialState,vo=(0,x.useModel)("api"),F=vo.fetchReloadAppSub,C=vo.fetchSave,R=(0,x.useModel)("alert"),xo=(0,c.useState)(!1),J=l()(xo,2),Po=J[0],$=J[1],v=n.url,B=co(v).index,Mo=(0,Yo.c)(function(){return{type:"grid",item:{id:v,originalIndex:B},collect:function(t){return{isDragging:t.isDragging()}},end:function(t,f){var K=t.id,N=f.didDrop();t.originalIndex!==B&&(N||a(K,t.originalIndex),C.run([{key:io.Z.userCfgs,val:JSON.stringify(s()(s()({},p==null?void 0:p.boxdata.usercfgs),{},{appsubs:uo}))}]))}}},[v,B,a]),V=l()(Mo,3),b=V[0].isDragging,Ao=V[1],no=V[2],Io=(0,To.L)(function(){return{accept:"grid",hover:function(t,f){var K;if(I.current){var N=t.index,ro=A;if(N!==ro){var Ro=(K=I.current)===null||K===void 0?void 0:K.getBoundingClientRect(),Lo=(Ro.bottom-Ro.top)/2,qo=f.getClientOffset(),Fo=qo.y-Ro.top;N<ro&&Fo<Lo||N>ro&&Fo>Lo||(a(t.id,ro),t.index=ro)}}}}},[co,a]),ho=l()(Io,2),X=ho[1],E=b?0:1;return Ao(X(I)),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(G.Z,{open:Po,onClose:function(){return $(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,o.jsx)(bo.Z,{id:"alert-dialog-title",children:"\u786E\u5B9A\u8981\u5220\u9664\u5F53\u524D\u8BA2\u9605\u5417\uFF1F"}),(0,o.jsx)(oo.Z,{children:(0,o.jsx)(Zo.Z,{id:"alert-dialog-description",children:(0,o.jsx)(m.Z,{children:(0,o.jsxs)(d.Z,{direction:"row",spacing:2,children:[(0,o.jsxs)(So,{variant:"dot",overlap:"circular",color:n.id?"success":"error",anchorOrigin:{vertical:"bottom",horizontal:"right"},sx:{position:"relative"},children:[(0,o.jsx)(eo.Z,{src:n.icon,sx:{border:"1px solid #e8e8e8",width:36,height:36}}),(((W=F.fetches[n.id])===null||W===void 0?void 0:W.loading)||((Z=F.fetches.all)===null||Z===void 0?void 0:Z.loading))&&(0,o.jsx)(Bo.Z,{size:40,sx:{position:"absolute",top:"50%",left:"50%",marginTop:"-23px",marginLeft:"-20px"}})]}),(0,o.jsxs)(d.Z,{sx:{overflow:"hidden",flex:"1 1"},children:[(0,o.jsxs)(d.Z,{children:[(0,o.jsx)(D.Z,{variant:"body2",gutterBottom:!0,ref:I,children:n.name}),(0,o.jsx)(zo,{color:"primary",badgeContent:n==null||(j=n.apps)===null||j===void 0?void 0:j.length,sx:{top:-15,right:13}})]}),(0,o.jsx)(D.Z,{noWrap:!0,variant:"body2",sx:{color:lo.Z[500],fontSize:12},children:n.repo})]})]})})})}),(0,o.jsxs)($o.Z,{children:[(0,o.jsx)(Eo.Z,{color:"inherit",onClick:function(){return $(!1)},children:"\u53D6\u6D88"}),(0,o.jsx)(Eo.Z,{color:"error",onClick:function(){$(!1);var t=p==null?void 0:p.boxdata.usercfgs.appsubs;t==null||t.splice(A,1),yo(t),p&&C.run([{key:io.Z.userCfgs,val:JSON.stringify(s()(s()({},p==null?void 0:p.boxdata.usercfgs),{},{appsubs:t}))}])},autoFocus:!0,children:"\u786E\u5B9A"})]})]}),(0,o.jsx)(m.Z,{ref:no,sx:{marginBottom:2,boxSizing:"border-box",opacity:E,transform:b?"translate(0,0)":"unset",zIndex:b?-1:"unset",position:"relative"},children:(0,o.jsxs)(Oo.Z,{className:Wo.dynamics,elevation:3,sx:{width:1,minHeight:20,borderRadius:4,padding:"20px 20px 12px 20px",boxSizing:"border-box"},children:[(0,o.jsx)(m.Z,{children:(0,o.jsxs)(d.Z,{direction:"row",spacing:2,children:[(0,o.jsxs)(So,{variant:"dot",overlap:"circular",color:n.id?"success":"error",anchorOrigin:{vertical:"bottom",horizontal:"right"},sx:{position:"relative"},children:[(0,o.jsx)(eo.Z,{src:n.icon,sx:{border:"1px solid #e8e8e8",width:36,height:36}}),(((z=F.fetches[n.id])===null||z===void 0?void 0:z.loading)||((L=F.fetches.all)===null||L===void 0?void 0:L.loading))&&(0,o.jsx)(Bo.Z,{size:40,sx:{position:"absolute",top:"50%",left:"50%",marginTop:"-23px",marginLeft:"-20px"}})]}),(0,o.jsxs)(d.Z,{sx:{overflow:"hidden",flex:"1 1"},children:[(0,o.jsxs)(d.Z,{children:[(0,o.jsx)(D.Z,{variant:"body2",gutterBottom:!0,ref:I,children:n.name}),(0,o.jsx)(zo,{color:"primary",badgeContent:n==null||(M=n.apps)===null||M===void 0?void 0:M.length,sx:{top:-15,right:13}})]}),(0,o.jsx)(D.Z,{noWrap:!0,variant:"body2",sx:{color:lo.Z[500],fontSize:12},children:n.repo})]})]})}),(0,o.jsx)(d.Z,{sx:{marginTop:1},children:(0,o.jsxs)(d.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,o.jsx)(P.Z,{color:"primary",component:"label",onClick:function(){Co()(n.url),R.alert({open:!0,message:"\u590D\u5236\u6210\u529F",type:"success"})},children:(0,o.jsx)(fo.Z,{})}),(0,o.jsx)(P.Z,{color:"primary",component:"label",onClick:function(){Co()(n.repo),R.alert({open:!0,message:"\u590D\u5236\u6210\u529F",type:"success"}),window.open(n.repo)},children:(0,o.jsx)(go.Z,{})}),(0,o.jsx)(P.Z,{color:"primary",component:"label",onClick:function(){Co()("".concat(window.location.href,"?add=").concat(encodeURIComponent(n.url))),R.alert({open:!0,message:"\u590D\u5236\u6210\u529F",type:"success"})},children:(0,o.jsx)(jo.Z,{})}),(0,o.jsx)(P.Z,{color:"success",component:"label",onClick:function(){F.run(n)},children:(0,o.jsx)(ao.Z,{})}),(0,o.jsx)(P.Z,{color:"error",component:"label",onClick:function(){$(!0)},children:(0,o.jsx)(mo.Z,{})}),(0,o.jsx)(D.Z,{noWrap:!0,gutterBottom:!0,variant:"overline",sx:{color:lo.Z[500],marginLeft:"auto !important"},children:(0,H.k6)(n.updateTime)})]})})]})})]})},Qo=c.forwardRef(function(g,i){return(0,o.jsx)("div",{ref:i,children:(0,o.jsx)(Xo,s()({},g))})});function ko(){var g,i,W=(0,x.useSearchParams)(),Z=l()(W,2),j=Z[0],z=Z[1],L=(0,c.useState)(!!j.get("add")),M=l()(L,2),n=M[0],A=M[1],co=(0,x.useModel)("@@initialState"),a=co.initialState,uo=(0,c.useRef)(),yo=(0,To.L)(function(){return{accept:"grid",collect:function(t){return{dragItem:t.getItem()}}}}),I=l()(yo,2),Do=I[0],p=I[1],vo=(0,x.useModel)("api"),F=vo.fetchReloadAppSub,C=a==null?void 0:a.boxdata,R=(C==null?void 0:C.usercfgs.appsubs)||[],xo=(C==null?void 0:C.appSubCaches)||{},J=a==null?void 0:a.boxdata.usercfgs,Po=(0,c.useState)(R||[]),$=l()(Po,2),v=$[0],B=$[1],Mo=(0,c.useState)(),V=l()(Mo,2),b=V[0],Ao=V[1],no=(0,c.useCallback)(function(r){var t=v.filter(function(f){return"".concat(f==null?void 0:f.url)==="".concat(r)})[0];return{card:t,index:v==null?void 0:v.indexOf(t)}},[v]),Io=(0,c.useCallback)(function(r,t){var f=no(r),K=f.card,N=f.index;B(Uo()(v,{$splice:[[N,1],[t,0,K]]}))},[no,v,B]);(0,c.useEffect)(function(){z({}),a!=null&&a.isMobile&&document.body.addEventListener("touchmove",function(r){Ao({x:r.touches[0].clientX,y:r.touches[0].clientY})}),R.length!==v.length&&B(R)},[R]);var ho=(g=Do.dragItem)===null||g===void 0?void 0:g.id,X=s()(s()({},xo[ho]),{},{url:ho}),E=(i=uo.current)===null||i===void 0?void 0:i.getBoundingClientRect();return(0,o.jsxs)(m.Z,{component:"div",children:[(0,o.jsx)(U,{open:n,onClose:function(){return A(!1)}}),(0,o.jsxs)(d.Z,{direction:"row",justifyContent:"space-between",children:[(0,o.jsx)(D.Z,{variant:"h5",sx:(0,H.V$)(J==null?void 0:J.bgimg),children:"\u5E94\u7528\u8BA2\u9605"}),(0,o.jsxs)(d.Z,{direction:"row",spacing:2,children:[(0,o.jsx)(P.Z,{color:"primary",component:"label",onClick:function(){window.open("https://docs.boxjs.app/awesome/subscriptions")},children:(0,o.jsx)(u.Z,{})}),(0,o.jsx)(P.Z,{color:"primary",component:"label",onClick:function(){F.run(void 0)},children:(0,o.jsx)(ao.Z,{})}),(0,o.jsx)(P.Z,{color:"primary",component:"label",onClick:function(){A(!0)},children:(0,o.jsx)(_.Z,{})})]})]}),(0,o.jsxs)(Ho.Z,{ref:p,component:"div",appear:!!(a!=null&&a.boxdata.usercfgs.isAnimate),children:[v.map(function(r,t){var f=s()(s()({},r),xo[r.url])||{name:"\u533F\u540D\u8BA2\u9605",repo:r.url,apps:[]};return(0,o.jsx)(Qo,{data:v,index:t,appItem:f,findCard:no,moveCard:Io,setCards:B},r.url)}),(0,o.jsx)(m.Z,{ref:uo,component:"div",sx:{display:X.id&&a!==null&&a!==void 0&&a.isMobile?"block":"none",zIndex:-1,opacity:.5,position:"fixed",left:((b==null?void 0:b.x)||0)-((E==null?void 0:E.width)||100)/2,top:((b==null?void 0:b.y)||0)-((E==null?void 0:E.height)||50)/2},children:(0,o.jsx)(Oo.Z,{className:Wo.dynamics,elevation:3,sx:{width:1,minHeight:20,borderRadius:4,padding:"20px 20px 12px 20px",boxSizing:"border-box"},children:(0,o.jsxs)(d.Z,{direction:"row",spacing:2,children:[(0,o.jsx)(So,{variant:"dot",overlap:"circular",color:X.id?"success":"error",anchorOrigin:{vertical:"bottom",horizontal:"right"},sx:{position:"relative"},children:(0,o.jsx)(eo.Z,{src:X.icon,sx:{border:"1px solid #e8e8e8",width:36,height:36}})}),(0,o.jsxs)(d.Z,{sx:{flex:"1 1"},children:[(0,o.jsx)(d.Z,{children:(0,o.jsx)(D.Z,{variant:"body2",gutterBottom:!0,sx:{flexGrow:1},children:X.name})}),(0,o.jsx)(D.Z,{noWrap:!0,variant:"body2",sx:{color:lo.Z[500],fontSize:12},children:"\u8BA2\u9605"})]})]})})})]})]})}function wo(){var g=(0,x.useModel)("@@initialState"),i=g.initialState;return(0,o.jsx)(m.Z,{pt:2,component:"div",children:(0,o.jsx)(Go.W,{options:{delay:400},backend:i!=null&&i.isMobile?Vo.zr:Jo.PD,children:(0,o.jsx)(ko,{})})})}},58291:function(po,S){S.Z={logo:"https://raw.githubusercontent.com/Orz-3/mini/master/Color/box.png",userCfgs:"chavy_boxjs_userCfgs",sessions:"chavy_boxjs_sessions",app_subCaches:"chavy_boxjs_app_subCaches",backups:"chavy_boxjs_backups",cursessions:"chavy_boxjs_cur_sessions",gistCacheKey:"@chavy_boxjs_userCfgs.gist_cache_key",viewkeys:"@chavy_boxjs_userCfgs.viewkeys"}}}]);
