"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[717],{6781:function(ko,k,o){o.r(k),o.d(k,{default:function(){return Xo}});var lo=o(97857),g=o.n(lo),ro=o(5574),W=o.n(ro),so=o(19632),E=o.n(so),w=o(58291),v=o(22148),uo=o(96214),vo=o(13505),co=o(43610),fo=o(63094),xo=o(1849),G=o(90948),ho=o(16323),mo=o(90872),q=o(60265),po=o(54128),K=o(69661),go=o(55137),H=o(87357),So=o(11984),bo=o(96486),Co=o.n(bo),$=o(67294),t=o(85893),jo=(0,G.ZP)(ho.Z)(function(h){var l=h.open;return{"& .MuiSpeedDial-actions":{height:l?"unset":"0"}}}),Zo=function(){var l,c,e,m,f,d=(0,$.useRef)(),C=(0,$.useState)(!1),x=W()(C,2),p=x[0],S=x[1],N=(0,$.useState)(!1),y=W()(N,2),P=y[0],R=y[1],O=(0,v.useModel)("api"),L=O.fetchSave,z=(0,v.useModel)("@@initialState"),a=z.initialState,A=a==null?void 0:a.boxdata.syscfgs.boxjs,u=a==null||(l=a.boxdata)===null||l===void 0?void 0:l.usercfgs,n=(0,$.useState)((u==null?void 0:u.actions_position)||{}),F=W()(n,2),I=F[0],V=F[1],j=a==null||(c=a.ui)===null||c===void 0?void 0:c.call(a,a==null?void 0:a.boxdata),D=(j==null?void 0:j.iconThemeIdx)!==void 0?j==null?void 0:j.iconThemeIdx:1,Z=a==null||(e=a.boxdata)===null||e===void 0||(m=e.syscfgs.envs)===null||m===void 0?void 0:m.find(function(r){var i;return r.id===(a==null||(i=a.boxdata)===null||i===void 0?void 0:i.syscfgs.env)}),Q=((f=window)===null||f===void 0?void 0:f.innerWidth)/2,J=function(i){var s,b;if(i.stopPropagation(),!!d.current){var M=i.touches[0],T={left:"unset",top:"unset",bottom:"unset",right:"unset"};T.left=M.clientX-((s=d.current)===null||s===void 0?void 0:s.getBoundingClientRect().width)/2,T.bottom=window.innerHeight-(M.clientY+((b=d.current)===null||b===void 0?void 0:b.getBoundingClientRect().height)/2),T.bottom<=100&&(T.bottom=100),T.bottom>=window.innerHeight-120&&(T.bottom=window.innerHeight-120),V(T)}};(0,$.useEffect)(function(){var r;return(r=d.current)===null||r===void 0||r.addEventListener("touchmove",J,{passive:!1}),function(){var i;(i=d.current)===null||i===void 0||i.removeEventListener("touchmove",J)}},[]);var Y=[].concat(E()(u!=null&&u.isHideHelp?[]:[{icon:(0,t.jsx)(fo.Z,{sx:{color:mo.Z[400]}}),name:"Help",onClick:function(){window.open("https://docs.boxjs.app/")}}]),E()(u!=null&&u.isHideRefresh?[]:[{icon:(0,t.jsx)(xo.Z,{sx:{color:q.Z[400]}}),name:"Refresh",onClick:function(){window.location.reload()}}]),[{icon:(0,t.jsx)(vo.Z,{sx:{color:po.Z[400]}}),name:"database",onClick:function(){v.history.push("/database")}}],E()((a==null?void 0:a.boxdata.syscfgs.env)==="Surge"?[{icon:(0,t.jsx)(K.Z,{alt:"BoxJs",src:(Z==null?void 0:Z.icons[D])||w.Z.logo,sx:{width:28,height:28,border:1,borderColor:"white"}}),name:"actions",onClick:function(){v.history.push("/actions")}}]:[]),E()(u!=null&&u.isHideCoding?[]:[{icon:(0,t.jsx)(uo.Z,{sx:{color:go.Z[400]}}),name:"Code",onClick:function(){v.history.push("/code")}}]));return(0,t.jsxs)(t.Fragment,{children:[p&&(0,t.jsx)("div",{style:{position:"fixed",zIndex:9998,left:0,top:0,right:0,bottom:0,background:"rgba(0,0,0,.2)"}}),(0,t.jsx)(H.Z,{ref:d,className:"cus-draggable",sx:g()({touchAction:"none",transform:"translateZ(0px)",flexGrow:1,position:"fixed",bottom:100,right:16,zIndex:9999},I),component:"div",onTouchStart:function(i){S(!0),i.stopPropagation()},onTouchEnd:function(i){if(S(!1),i.stopPropagation(),!Co().isEqual(I,u==null?void 0:u.actions_position)){var s=g()({},I);Number(s.left)>Q?(s.left="unset",s.right=16):(s.left=16,s.right="unset"),V(s),L.run({key:"@".concat(w.Z.userCfgs,".actions_position"),val:s})}},children:(0,t.jsx)(jo,{open:P,onClose:function(i){R(!1),i.preventDefault()},onClick:function(i){R(!P),i.preventDefault()},FabProps:{size:"medium"},ariaLabel:"SpeedDial controlled open example",icon:(0,t.jsx)(K.Z,{alt:"BoxJS",src:A==null?void 0:A.icons[D],sx:{width:1,height:1},children:(0,t.jsx)(co.Z,{color:"error"})}),children:Y.map(function(r){return(0,t.jsx)(So.Z,{icon:r.icon,tooltipTitle:r.name,onClick:r.onClick},r.name)})})})]})},yo=Zo,Mo=o(76638),To=o(81261),$o=o(78579),Po=o(98456),Ro=o(90629),Do=o(21528),Ho=o(2359),Bo=o(97458),U={footer_container:"footer_container___QFPpy",footer_container_tow:"footer_container_tow___BWiJC",footer_bar:"footer_bar___Lok0r"},No=function(){var l=(0,v.useLocation)(),c=(0,v.useModel)("@@initialState"),e=c.initialState,m=(0,v.useModel)("api"),f=m.loading,d=e==null?void 0:e.boxdata,C={"/":{value:"/",icon:(0,t.jsx)(Mo.Z,{})},"/app":{value:"/app",icon:(0,t.jsx)($o.Z,{})},"/sub":{value:"/sub",icon:(0,t.jsx)(To.Z,{})},"/my":{value:"/my",icon:(0,t.jsxs)(H.Z,{sx:{position:"relative"},children:[(0,t.jsx)(K.Z,{alt:"boxJS",src:(d==null?void 0:d.usercfgs.icon)||w.Z.logo,sx:{width:24,height:24}}),f&&(0,t.jsx)(Po.Z,{size:24,sx:{position:"absolute",top:"50%",left:"50%",marginTop:"-12px",marginLeft:"-12px"}})]})}};return(0,t.jsx)(Bo.Z,{type:["bottom","bottom"],appear:!!(e!=null&&e.boxdata.usercfgs.isAnimate),children:e!=null&&e.boxdata.usercfgs.isHidedNaviBottom?null:(0,t.jsx)(H.Z,{className:d!=null&&d.usercfgs.isTraditionalMenu?U.footer_container_tow:U.footer_container,children:(0,t.jsx)(Ro.Z,{className:U.footer_bar,sx:{borderRadius:7,overflow:"hidden",boxShadow:function(p){return"0px 0 3px ".concat(p.palette.primary.main)}},children:(0,t.jsx)(Do.Z,{showLabels:!0,value:l.pathname,onChange:function(p,S){v.history.push(S)},sx:{"& .Mui-selected":{"&:after":{width:.3}}},children:Object.keys(C).map(function(x){return(0,t.jsx)(Ho.Z,g()(g()({},C[x]),{},{sx:{"&:after":{content:'""',position:"absolute",height:2,width:0,borderRadius:1,background:function(S){return S.palette.primary.main},top:1,transition:"width 0.3s linear",boxShadow:1}}}),x)})})},"paper")})})},Ao=No,Oo=o(44842),_=o(47036),Lo=o(39005),oo=o(15861),to=(0,G.ZP)(H.Z)(function(h){var l=h.theme;return{backgroundColor:l.palette.mode==="light"?"#fff":_.Z[800]}}),Fo=(0,G.ZP)(H.Z)(function(h){var l=h.theme;return{width:30,height:6,backgroundColor:l.palette.primary.main,borderRadius:3,position:"absolute",top:8,left:"calc(50% - 15px)",boxShadow:l.shadows[1]}}),Io=function(l){var c;return l.value?(0,t.jsx)("div",{children:(0,t.jsxs)(Lo.Z,{anchor:"bottom",swipeAreaWidth:0,open:l.open||!1,container:function(){return window.document.body},onClose:function(){return l.onClose()},onOpen:function(){return l.onClose()},disableSwipeToOpen:!1,ModalProps:{keepMounted:!0},sx:{"& .MuiDrawer-paperAnchorBottom":{maxHeight:"60%",minHeight:"30%",borderTopLeftRadius:8,borderTopRightRadius:8,overflow:"hidden"}},children:[(0,t.jsxs)(to,{sx:{position:"absolute",top:0,visibility:"visible",right:0,left:0,boxShadow:function(m){return m.shadows[1]}},children:[(0,t.jsx)(Fo,{onClick:function(){return l.onClose()}}),(0,t.jsx)(oo.Z,{sx:{p:2,color:"text.secondary"},children:"\u8FD0\u884C\u7ED3\u679C"})]}),(0,t.jsx)(to,{sx:{px:2,pb:2,mt:7,overflow:"auto"},children:(0,t.jsx)(oo.Z,{variant:"caption",color:"grey",component:"p",sx:{whiteSpace:"pre-wrap",wordBreak:"break-word",pt:2},children:((c=l.value)===null||c===void 0?void 0:c.output)||JSON.stringify(l.value||"\u6682\u65E0\u7ED3\u679C")})})]})}):null},Jo=Io,no=o(5554),Wo=o(43619),Eo=o(22430),wo=o(66720),zo=function(l){var c=(0,v.useModel)("@@initialState"),e=c.initialState,m=c.setInitialState,f=e==null?void 0:e.boxdata,d=e==null?void 0:e.mode,C=$.useMemo(function(){return{toggleColorMode:function(y){var P=(0,no.nH)(),R=y==="auto"?P:y;e&&m(g()(g()({},e),{},{mode:R}))}}},[e]),x=(f==null?void 0:f.usercfgs.color_light_primary)||q.Z[500],p=(f==null?void 0:f.usercfgs.color_dark_primary)||_.Z[500],S=$.useMemo(function(){return(0,Wo.Z)({palette:{mode:d,primary:{main:d==="light"?x:p,light:x,dark:p}}})},[d,x,p]);return(0,t.jsx)(no.kc.Provider,{value:C,children:(0,t.jsxs)(Eo.Z,{theme:S,children:[(0,t.jsx)(wo.ZP,{}),l.children]})})},Vo=zo,Qo=o(65582),io=o(58703),ao=o(54776),Go=o(21737),Ko=o(71415),Uo=o.n(Ko),B={container:"container___MJ5pp",content:"content___FEk3q",container_top:"container_top___QFCHo",my:"my___FfjD2",alert:"alert___K4HMe"},X;function Xo(){var h,l,c,e,m,f,d,C,x,p,S,N,y,P,R,O,L,z=(0,v.useLocation)(),a=(0,v.useModel)("alert"),A=(0,v.useModel)("log"),u=(0,v.useModel)("@@initialState"),n=u.initialState,F=(0,v.useModel)("api"),I=F.fetchRunScript,V=F.fetchSave,j=function(){a.alert({})},D=n==null||(h=n.boxdata)===null||h===void 0||(l=h.usercfgs)===null||l===void 0?void 0:l.bgimg,Z=n==null||(c=n.boxdata)===null||c===void 0||(e=c.usercfgs)===null||e===void 0||(m=e.bgimgs)===null||m===void 0||(f=m.split(`
`))===null||f===void 0?void 0:f.map(function(i){var s=(i==null?void 0:i.split(","))||[],b=W()(s,2),M=b[0],T=M===void 0?"":M,eo=b[1],Yo=eo===void 0?"":eo;return{name:T,url:Yo}});if(D==="\u8DDF\u968F\u7CFB\u7EDF"){var Q=Z==null?void 0:Z.find(function(i){return i.name=="\u6697\u9ED1"||i.name=="dark"}),J=Z==null?void 0:Z.find(function(i){return i.name=="\u660E\u4EAE"||i.name=="light"}),Y=Q?Q.url:"",r=J?J.url:"";(n==null?void 0:n.mode)==="dark"?D=Y:D=r}return(0,$.useEffect)(function(){var i,s;if(document.oncontextmenu=function(){return!1},n!=null&&(i=n.boxdata)!==null&&i!==void 0&&i.usercfgs.isVConsole)X=new(Uo())({theme:n==null?void 0:n.mode});else if(!(n!=null&&(s=n.boxdata)!==null&&s!==void 0&&s.usercfgs.isVConsole)&&X){var b,M;(b=X)===null||b===void 0||(M=b.destroy)===null||M===void 0||M.call(b)}n!=null&&n.boxdata.usercfgs.isWallpaperMode&&setTimeout(function(){V.run([{key:w.Z.userCfgs,val:JSON.stringify(g()(g()({},n==null?void 0:n.boxdata.usercfgs),{},{isWallpaperMode:!1}))}])},3e3)},[n==null||(d=n.boxdata)===null||d===void 0?void 0:d.usercfgs.isVConsole,n==null?void 0:n.boxdata.usercfgs.isWallpaperMode]),(0,t.jsxs)(Vo,{children:[(0,t.jsxs)(H.Z,{className:n!=null&&(C=n.boxdata)!==null&&C!==void 0&&C.usercfgs.isWaitToggleSearchBar?B.container_top:B.container,children:[!["/my"].includes(z.pathname)&&(0,t.jsx)(Oo.ZP,{}),(n==null||(x=n.boxdata)===null||x===void 0||(p=x.usercfgs)===null||p===void 0?void 0:p.isHideBoxIcon)!==!0&&(0,t.jsx)(yo,{}),(0,t.jsx)("div",{draggable:!1,style:{position:"fixed",top:0,left:0,bottom:0,right:0,zIndex:-1,backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundColor:"transparent",backgroundImage:D?"linear-gradient(to bottom,rgba(0,0,0,.2) 0,transparent 76px), url(".concat(D,"?_=").concat(n==null?void 0:n.random,")"):void 0}}),(0,t.jsxs)(Qo.Z,{fixed:!0,maxWidth:!1,className:"".concat(B.content," ").concat(B[z.pathname.replace("/","")]),children:[n!=null&&n.boxdata.usercfgs.isWallpaperMode?null:(0,t.jsx)(v.Outlet,{}),(S=a.options)!==null&&S!==void 0&&S.type?(0,t.jsx)(io.Z,{className:B.alert,autoHideDuration:2e3,onClose:function(){return j()},open:(N=a.options)===null||N===void 0?void 0:N.open,anchorOrigin:{vertical:"top",horizontal:"left"},TransitionComponent:function(s){return(0,t.jsx)(ao.Z,g()(g()({},s),{},{direction:"down"}))},children:(0,t.jsx)(Go.Z,{sx:{width:"100%"},onClose:function(){return j()},severity:(y=a.options)===null||y===void 0?void 0:y.type,children:(P=a.options)===null||P===void 0?void 0:P.message})},a.options.key):(0,t.jsx)(io.Z,{className:B.alert,autoHideDuration:1e3,onClose:function(){return j()},open:(R=a.options)===null||R===void 0?void 0:R.open,anchorOrigin:{vertical:"top",horizontal:"left"},TransitionComponent:function(s){return(0,t.jsx)(ao.Z,g()(g()({},s),{},{direction:"down"}))},message:(O=a.options)!==null&&O!==void 0&&O.type||(L=a.options)===null||L===void 0?void 0:L.message},a.options.key)]}),(0,t.jsx)(Ao,{})]}),(0,t.jsx)(Jo,{open:A.visible,value:I.data,onClose:function(){return A.setVisible(!1)}})]})}}}]);
