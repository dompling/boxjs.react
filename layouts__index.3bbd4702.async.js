"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[717],{86597:function(vo,k,o){o.r(k),o.d(k,{default:function(){return ot}});var co=o(97857),m=o.n(co),fo=o(5574),G=o.n(fo),xo=o(19632),U=o.n(xo),X=o(34747),ho=o(18115),J=o(58291),c=o(22148),mo=o(96214),go=o(13505),po=o(43610),So=o(63094),bo=o(1849),q=o(90948),Co=o(16323),Zo=o(90872),jo=o(60265),yo=o(54128),_=o(69661),To=o(55137),z=o(87357),$o=o(11984),Mo=o(96486),oo=o.n(Mo),L=o(67294),t=o(85893),Bo=(0,q.ZP)(Co.Z)(function(g){var e=g.open;return{"& .MuiSpeedDial-actions":{height:e?"unset":"0"}}}),No=function(){var e,f,i,p,B,N,r,R,S,b=(0,L.useRef)(),E=(0,L.useState)(!1),A=G()(E,2),x=A[0],d=A[1],Z=(0,L.useState)(!1),y=G()(Z,2),T=y[0],h=y[1],Y=(0,c.useModel)("api"),no=Y.fetchSave,n=(0,c.useModel)("@@initialState"),a=n.initialState,F=a==null?void 0:a.boxdata.syscfgs.boxjs,v=a==null||(e=a.boxdata)===null||e===void 0?void 0:e.usercfgs,w=(0,L.useState)((v==null?void 0:v.actions_position)||{}),P=G()(w,2),$=P[0],V=P[1],D=a==null||(f=a.ui)===null||f===void 0?void 0:f.call(a,a==null?void 0:a.boxdata),K=(D==null?void 0:D.iconThemeIdx)!==void 0?D==null?void 0:D.iconThemeIdx:1,Q=a==null||(i=a.boxdata)===null||i===void 0||(p=i.syscfgs.envs)===null||p===void 0?void 0:p.find(function(l){var u;return l.id===(a==null||(u=a.boxdata)===null||u===void 0?void 0:u.syscfgs.env)}),s=((B=window)===null||B===void 0?void 0:B.innerWidth)/2,C=(((N=document.getElementsByClassName(ho.Z.header_container))===null||N===void 0||(r=N[0])===null||r===void 0?void 0:r.getBoundingClientRect().height)||160)+30,M=(((R=document.getElementsByClassName(X.Z.footer_container))===null||R===void 0||(S=R[0])===null||S===void 0?void 0:S.getBoundingClientRect().height)||100)+15,H=function(u){var j,eo;if(!T&&(u.stopPropagation(),!!b.current)){var uo=u.touches[0],O={left:"unset",top:"unset",bottom:"unset",right:"unset"};O.left=uo.clientX-((j=b.current)===null||j===void 0?void 0:j.getBoundingClientRect().width)/2,O.bottom=window.innerHeight-(uo.clientY+((eo=b.current)===null||eo===void 0?void 0:eo.getBoundingClientRect().height)/2),O.bottom<=M&&(O.bottom=M),O.bottom>=window.innerHeight-C&&(O.bottom=window.innerHeight-C),V(O)}};(0,L.useEffect)(function(){if(!T){var l;(l=b.current)===null||l===void 0||l.addEventListener("touchmove",H,{passive:!1})}return function(){var u;(u=b.current)===null||u===void 0||u.removeEventListener("touchmove",H)}},[T]);var io=[].concat(U()(v!=null&&v.isHideHelp?[]:[{icon:(0,t.jsx)(So.Z,{sx:{color:Zo.Z[400]}}),name:"Help",onClick:function(){window.open("https://docs.boxjs.app/")}}]),U()(v!=null&&v.isHideRefresh?[]:[{icon:(0,t.jsx)(bo.Z,{sx:{color:jo.Z[400]}}),name:"Refresh",onClick:function(){window.location.reload()}}]),[{icon:(0,t.jsx)(go.Z,{sx:{color:yo.Z[400]}}),name:"database",onClick:function(){c.history.push("/database")}}],U()((a==null?void 0:a.boxdata.syscfgs.env)==="Surge"?[{icon:(0,t.jsx)(_.Z,{alt:"BoxJs",src:(Q==null?void 0:Q.icons[K])||J.Z.logo,sx:{width:28,height:28,border:1,borderColor:"white"}}),name:"actions",onClick:function(){c.history.push("/actions")}}]:[]),U()(v!=null&&v.isHideCoding?[]:[{icon:(0,t.jsx)(mo.Z,{sx:{color:To.Z[400]}}),name:"Code",onClick:function(){c.history.push("/code")}}]));return(0,t.jsxs)(t.Fragment,{children:[x&&(0,t.jsx)("div",{style:{position:"fixed",zIndex:98,left:0,top:0,right:0,bottom:0}}),(0,t.jsx)(z.Z,{ref:b,className:"cus-draggable",sx:m()({touchAction:"none",transform:"translateZ(0px)",flexGrow:1,position:"fixed",bottom:100,right:16,zIndex:99},$),component:"div",onTouchStart:function(u){T||(d(!0),u.stopPropagation())},onTouchEnd:function(u){if(d(!1),!T&&(u.stopPropagation(),!oo().isEqual($,v==null?void 0:v.actions_position))){var j=m()({},$);Number(j.left)>s?(j.left="unset",j.right=16):(j.left=16,j.right="unset"),V(j),no.run({key:"@".concat(J.Z.userCfgs,".actions_position"),val:j})}},children:(0,t.jsx)(Bo,{open:T&&!x,onClose:function(u){h(!1),u.preventDefault()},onClick:function(u){h(!T),u.preventDefault()},FabProps:{size:"medium"},ariaLabel:"SpeedDial controlled open example",icon:(0,t.jsx)(_.Z,{alt:"BoxJS",src:F==null?void 0:F.icons[K],sx:{width:1,height:1},children:(0,t.jsx)(po.Z,{color:"error"})}),children:io.map(function(l){return(0,t.jsx)($o.Z,{icon:l.icon,tooltipTitle:l.name,onClick:l.onClick},l.name)})})})]})},Ro=No,Ao=o(83025),Do=o(76638),Ho=o(81261),Eo=o(78579),Po=o(98456),Oo=o(90629),zo=o(21528),Lo=o(2359),Io=o(97458),W=[],Jo=function(){var e=(0,c.useLocation)(),f=(0,c.useModel)("@@initialState"),i=f.initialState,p=(0,c.useModel)("api"),B=p.loading,N=p.fetchSave,r=i==null?void 0:i.boxdata,R=(r==null?void 0:r.datas["@SET_TIME.CACHE"])||[],S=30,b=function(){N.run([{key:J.Z.userCfgs,val:JSON.stringify(m()(m()({},i==null?void 0:i.boxdata.usercfgs),{},{isHideBoxIcon:!(r!=null&&r.usercfgs.isHideBoxIcon)}))}])},E=m()(m()({"/home":{value:"/home",icon:(0,t.jsx)(Do.Z,{sx:{fontSize:S}})}},R.length?{"/task":{value:"/task",icon:(0,t.jsx)(Ao.Z,{sx:{fontSize:S}})}}:{}),{},{"/app":{value:"/app",icon:(0,t.jsx)(Eo.Z,{sx:{fontSize:S}})},"/sub":{value:"/sub",icon:(0,t.jsx)(Ho.Z,{sx:{fontSize:S}})},"/my":{value:"/my",icon:(0,t.jsxs)(z.Z,{sx:{position:"relative"},children:[(0,t.jsx)(_.Z,{alt:"boxJS",src:(r==null?void 0:r.usercfgs.icon)||J.Z.logo,sx:{width:34,height:34,boxSizing:"border-box",border:function(d){return"1px solid ".concat(d.palette.primary.main)}}}),B&&(0,t.jsx)(Po.Z,{size:35,sx:{position:"absolute",top:"50%",left:"50%",marginTop:"-17px",marginLeft:"-17px"}})]})}}),A=function(d){if(e.pathname!==d.value)if(d.value==="/my"&&i!==null&&i!==void 0&&i.boxdata.usercfgs){var Z=oo().debounce(function(){c.history.push(d.value),W=[]},200);return W.push(Z),W.length===2?(oo().map(W,function(y){return y.cancel()}),W=[],b()):Z()}else c.history.push(d.value)};return(0,t.jsx)(Io.Z,{type:["bottom","bottom"],appear:!!(i!=null&&i.boxdata.usercfgs.isAnimate),children:i!=null&&i.boxdata.usercfgs.isHidedNaviBottom?null:(0,t.jsx)(z.Z,{className:r!=null&&r.usercfgs.isTraditionalMenu?X.Z.footer_container_tow:X.Z.footer_container,children:(0,t.jsx)(Oo.Z,{className:X.Z.footer_bar,sx:{borderRadius:7,overflow:"hidden",boxShadow:function(d){return"0px 0 3px ".concat(d.palette.primary.main)}},children:(0,t.jsx)(zo.Z,{showLabels:!0,value:e.pathname,sx:{"& .Mui-selected":{"&:after":{width:.3}}},children:Object.keys(E).map(function(x){var d=E[x];return(0,t.jsx)(Lo.Z,{icon:d.icon,value:d.value,onTouchEnd:function(){return A(d)},onClick:function(){return!(i!=null&&i.isMobile)&&A(d)},sx:{"&:after":{content:'""',position:"absolute",height:2,width:0,borderRadius:1,background:function(y){return y.palette.primary.main},top:1,transition:"width 0.3s linear",boxShadow:1}}},x)})})},"paper")})})},Wo=Jo,Fo=o(33525),wo=o(47036),Vo=o(39005),ao=o(15861),lo=(0,q.ZP)(z.Z)(function(g){var e=g.theme;return{backgroundColor:e.palette.mode==="light"?"#fff":wo.Z[800]}}),Qo=(0,q.ZP)(z.Z)(function(g){var e=g.theme;return{width:30,height:6,backgroundColor:e.palette.primary.main,borderRadius:3,position:"absolute",top:8,left:"calc(50% - 15px)",boxShadow:e.shadows[1]}}),ko=function(e){var f;return e.value?(0,t.jsx)("div",{children:(0,t.jsxs)(Vo.Z,{anchor:"bottom",swipeAreaWidth:0,open:e.open||!1,container:function(){return window.document.body},onClose:function(){return e.onClose()},onOpen:function(){return e.onClose()},disableSwipeToOpen:!1,ModalProps:{keepMounted:!0},sx:{zIndex:9999,"& .MuiDrawer-paperAnchorBottom":{maxHeight:"60%",minHeight:"30%",borderTopLeftRadius:8,borderTopRightRadius:8,overflow:"hidden"}},children:[(0,t.jsxs)(lo,{sx:{position:"absolute",top:0,visibility:"visible",right:0,left:0,boxShadow:function(p){return p.shadows[1]}},children:[(0,t.jsx)(Qo,{onClick:function(){return e.onClose()}}),(0,t.jsx)(ao.Z,{sx:{p:2,color:"text.secondary"},children:"\u8FD0\u884C\u7ED3\u679C"})]}),(0,t.jsx)(lo,{sx:{px:2,pb:2,mt:7,overflow:"auto"},children:(0,t.jsx)(ao.Z,{variant:"caption",color:"grey",component:"p",sx:{whiteSpace:"pre-wrap",wordBreak:"break-word",pt:2},children:((f=e.value)===null||f===void 0?void 0:f.output)||JSON.stringify(e.value||"\u6682\u65E0\u7ED3\u679C")})})]})}):null},Go=ko,Uo=o(38281),Xo=o(65582),so=o(58703),ro=o(54776),Yo=o(21737),Ko=o(71415),qo=o.n(Ko),_o=o(42438),I=o(80410),to;function ot(){var g,e,f,i,p,B,N,r,R,S,b,E,A,x,d,Z,y,T=(0,c.useLocation)(),h=(0,c.useModel)("alert"),Y=(0,c.useModel)("log"),no=(0,c.useModel)("@@initialState"),n=no.initialState,a=(0,c.useModel)("api"),F=a.fetchRunScript,v=a.fetchSave,w=function(){h.alert({})},P=n==null||(g=n.boxdata)===null||g===void 0||(e=g.usercfgs)===null||e===void 0?void 0:e.bgimg,$=n==null||(f=n.boxdata)===null||f===void 0||(i=f.usercfgs)===null||i===void 0||(p=i.bgimgs)===null||p===void 0||(B=p.split(`
`))===null||B===void 0?void 0:B.map(function(s){var C=(s==null?void 0:s.split(","))||[],M=G()(C,2),H=M[0],io=H===void 0?"":H,l=M[1],u=l===void 0?"":l;return{name:io,url:u}});if(P==="\u8DDF\u968F\u7CFB\u7EDF"){var V=$==null?void 0:$.find(function(s){return s.name=="\u6697\u9ED1"||s.name=="dark"}),D=$==null?void 0:$.find(function(s){return s.name=="\u660E\u4EAE"||s.name=="light"}),K=V?V.url:"",Q=D?D.url:"";(n==null?void 0:n.mode)==="dark"?P=K:P=Q}return(0,L.useEffect)(function(){var s,C;if(document.oncontextmenu=function(){return!1},n!=null&&(s=n.boxdata)!==null&&s!==void 0&&s.usercfgs.isVConsole)to=new(qo())({theme:n==null?void 0:n.mode});else if(!(n!=null&&(C=n.boxdata)!==null&&C!==void 0&&C.usercfgs.isVConsole)&&to){var M,H;(M=to)===null||M===void 0||(H=M.destroy)===null||H===void 0||H.call(M)}n!=null&&n.boxdata.usercfgs.isWallpaperMode&&setTimeout(function(){v.run([{key:J.Z.userCfgs,val:JSON.stringify(m()(m()({},n==null?void 0:n.boxdata.usercfgs),{},{isWallpaperMode:!1}))}])},3e3)},[n==null||(N=n.boxdata)===null||N===void 0?void 0:N.usercfgs.isVConsole,n==null?void 0:n.boxdata.usercfgs.isWallpaperMode]),(0,t.jsxs)(Uo.Z,{children:[(0,t.jsxs)(z.Z,{className:n!=null&&(r=n.boxdata)!==null&&r!==void 0&&r.usercfgs.isWaitToggleSearchBar?I.Z.container_top:I.Z.container,children:[!["/my"].includes(T.pathname)&&(0,t.jsx)(Fo.ZP,{}),(0,t.jsx)("div",{draggable:!1,style:{position:"fixed",top:0,left:0,bottom:0,right:0,zIndex:-1,backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundColor:"transparent",backgroundImage:P?"linear-gradient(to bottom,rgba(0,0,0,.2) 0,transparent 76px), url(".concat(P,"?_=").concat(n==null?void 0:n.random,")"):void 0}}),(0,t.jsxs)(Xo.Z,{fixed:!0,maxWidth:!1,className:"".concat(I.Z.content," ").concat(I.Z[T.pathname.replace("/","")]),children:[n!=null&&n.boxdata.usercfgs.isWallpaperMode?null:(0,t.jsx)(c.Outlet,{}),(0,t.jsx)(_o.Z,{}),(R=h.options)!==null&&R!==void 0&&R.type?(0,t.jsx)(so.Z,{className:I.Z.alert,autoHideDuration:2e3,onClose:function(){return w()},open:(S=h.options)===null||S===void 0?void 0:S.open,anchorOrigin:{vertical:"top",horizontal:"left"},TransitionComponent:function(C){return(0,t.jsx)(ro.Z,m()(m()({},C),{},{direction:"down"}))},children:(0,t.jsx)(Yo.Z,{sx:{width:"100%"},onClose:function(){return w()},severity:(b=h.options)===null||b===void 0?void 0:b.type,children:(E=h.options)===null||E===void 0?void 0:E.message})},h.options.key):(0,t.jsx)(so.Z,{className:I.Z.alert,autoHideDuration:1e3,onClose:function(){return w()},open:(A=h.options)===null||A===void 0?void 0:A.open,anchorOrigin:{vertical:"top",horizontal:"left"},TransitionComponent:function(C){return(0,t.jsx)(ro.Z,m()(m()({},C),{},{direction:"down"}))},message:(x=h.options)!==null&&x!==void 0&&x.type||(d=h.options)===null||d===void 0?void 0:d.message},h.options.key)]}),(0,t.jsx)(Wo,{})]}),(n==null||(Z=n.boxdata)===null||Z===void 0||(y=Z.usercfgs)===null||y===void 0?void 0:y.isHideBoxIcon)!==!0&&(0,t.jsx)(Ro,{}),(0,t.jsx)(Go,{open:Y.visible,value:F.data,onClose:function(){return Y.setVisible(!1)}})]})}},34747:function(vo,k){k.Z={footer_container:"footer_container___QFPpy",footer_container_tow:"footer_container_tow___BWiJC",footer_bar:"footer_bar___Lok0r"}}}]);
