"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[717],{69360:function(vo,k,o){o.r(k),o.d(k,{default:function(){return qo}});var co=o(97857),y=o.n(co),fo=o(5574),G=o.n(fo),xo=o(19632),K=o.n(xo),U=o(34747),ho=o(18115),J=o(58291),c=o(22148),mo=o(96214),po=o(13505),go=o(43610),So=o(63094),bo=o(1849),q=o(90948),Co=o(16323),Zo=o(90872),yo=o(60265),jo=o(54128),_=o(69661),Mo=o(55137),O=o(87357),$o=o(11984),To=o(96486),oo=o.n(To),z=o(67294),t=o(85893),Bo=(0,q.ZP)(Co.Z)(function(p){var e=p.open;return{"& .MuiSpeedDial-actions":{height:e?"unset":"0"}}}),Do=function(){var e,f,i,g,T,B,u,C,D,x=(0,z.useRef)(),A=(0,z.useState)(!1),h=G()(A,2),s=h[0],S=h[1],H=(0,z.useState)(!1),I=G()(H,2),j=I[0],m=I[1],X=(0,c.useModel)("api"),no=X.fetchSave,n=(0,c.useModel)("@@initialState"),a=n.initialState,w=a==null?void 0:a.boxdata.syscfgs.boxjs,v=a==null||(e=a.boxdata)===null||e===void 0?void 0:e.usercfgs,W=(0,z.useState)((v==null?void 0:v.actions_position)||{}),E=G()(W,2),M=E[0],V=E[1],N=a==null||(f=a.ui)===null||f===void 0?void 0:f.call(a,a==null?void 0:a.boxdata),Y=(N==null?void 0:N.iconThemeIdx)!==void 0?N==null?void 0:N.iconThemeIdx:1,Q=a==null||(i=a.boxdata)===null||i===void 0||(g=i.syscfgs.envs)===null||g===void 0?void 0:g.find(function(l){var d;return l.id===(a==null||(d=a.boxdata)===null||d===void 0?void 0:d.syscfgs.env)}),r=((T=window)===null||T===void 0?void 0:T.innerWidth)/2,b=(((B=document.getElementsByClassName(ho.Z.header_container))===null||B===void 0||(u=B[0])===null||u===void 0?void 0:u.getBoundingClientRect().height)||160)+30,$=(((C=document.getElementsByClassName(U.Z.footer_container))===null||C===void 0||(D=C[0])===null||D===void 0?void 0:D.getBoundingClientRect().height)||100)+15,R=function(d){var Z,eo;if(!j&&(d.stopPropagation(),!!x.current)){var uo=d.touches[0],P={left:"unset",top:"unset",bottom:"unset",right:"unset"};P.left=uo.clientX-((Z=x.current)===null||Z===void 0?void 0:Z.getBoundingClientRect().width)/2,P.bottom=window.innerHeight-(uo.clientY+((eo=x.current)===null||eo===void 0?void 0:eo.getBoundingClientRect().height)/2),P.bottom<=$&&(P.bottom=$),P.bottom>=window.innerHeight-b&&(P.bottom=window.innerHeight-b),V(P)}};(0,z.useEffect)(function(){if(!j){var l;(l=x.current)===null||l===void 0||l.addEventListener("touchmove",R,{passive:!1})}return function(){var d;(d=x.current)===null||d===void 0||d.removeEventListener("touchmove",R)}},[j]);var io=[].concat(K()(v!=null&&v.isHideHelp?[]:[{icon:(0,t.jsx)(So.Z,{sx:{color:Zo.Z[400]}}),name:"Help",onClick:function(){window.open("https://docs.boxjs.app/")}}]),K()(v!=null&&v.isHideRefresh?[]:[{icon:(0,t.jsx)(bo.Z,{sx:{color:yo.Z[400]}}),name:"Refresh",onClick:function(){window.location.reload()}}]),[{icon:(0,t.jsx)(po.Z,{sx:{color:jo.Z[400]}}),name:"database",onClick:function(){c.history.push("/database")}}],K()((a==null?void 0:a.boxdata.syscfgs.env)==="Surge"?[{icon:(0,t.jsx)(_.Z,{alt:"BoxJs",src:(Q==null?void 0:Q.icons[Y])||J.Z.logo,sx:{width:28,height:28,border:1,borderColor:"white"}}),name:"actions",onClick:function(){c.history.push("/actions")}}]:[]),K()(v!=null&&v.isHideCoding?[]:[{icon:(0,t.jsx)(mo.Z,{sx:{color:Mo.Z[400]}}),name:"Code",onClick:function(){c.history.push("/code")}}]));return(0,t.jsxs)(t.Fragment,{children:[s&&(0,t.jsx)("div",{style:{position:"fixed",zIndex:98,left:0,top:0,right:0,bottom:0}}),(0,t.jsx)(O.Z,{ref:x,className:"cus-draggable",sx:y()({touchAction:"none",transform:"translateZ(0px)",flexGrow:1,position:"fixed",bottom:100,right:16,zIndex:99},M),component:"div",onTouchStart:function(d){j||(S(!0),d.stopPropagation())},onTouchEnd:function(d){if(S(!1),!j&&(d.stopPropagation(),!oo().isEqual(M,v==null?void 0:v.actions_position))){var Z=y()({},M);Number(Z.left)>r?(Z.left="unset",Z.right=16):(Z.left=16,Z.right="unset"),V(Z),no.run({key:"@".concat(J.Z.userCfgs,".actions_position"),val:Z})}},children:(0,t.jsx)(Bo,{open:j&&!s,onClose:function(d){m(!1),d.preventDefault()},onClick:function(d){m(!j),d.preventDefault()},FabProps:{size:"medium"},ariaLabel:"SpeedDial controlled open example",icon:(0,t.jsx)(_.Z,{alt:"BoxJS",src:w==null?void 0:w.icons[Y],sx:{width:1,height:1},children:(0,t.jsx)(go.Z,{color:"error"})}),children:io.map(function(l){return(0,t.jsx)($o.Z,{icon:l.icon,tooltipTitle:l.name,onClick:l.onClick},l.name)})})})]})},Ho=Do,No=o(76638),Ro=o(81261),Ao=o(78579),Eo=o(98456),Po=o(90629),Oo=o(21528),zo=o(2359),Lo=o(97458),L=[],Fo=function(){var e=(0,c.useLocation)(),f=(0,c.useModel)("@@initialState"),i=f.initialState,g=(0,c.useModel)("api"),T=g.loading,B=g.fetchSave,u=i==null?void 0:i.boxdata,C=30,D=function(){B.run([{key:J.Z.userCfgs,val:JSON.stringify(y()(y()({},i==null?void 0:i.boxdata.usercfgs),{},{isHideBoxIcon:!(u!=null&&u.usercfgs.isHideBoxIcon)}))}])},x={"/home":{value:"/home",icon:(0,t.jsx)(No.Z,{sx:{fontSize:C}})},"/app":{value:"/app",icon:(0,t.jsx)(Ao.Z,{sx:{fontSize:C}})},"/sub":{value:"/sub",icon:(0,t.jsx)(Ro.Z,{sx:{fontSize:C}})},"/my":{value:"/my",icon:(0,t.jsxs)(O.Z,{sx:{position:"relative"},children:[(0,t.jsx)(_.Z,{alt:"boxJS",src:(u==null?void 0:u.usercfgs.icon)||J.Z.logo,sx:{width:34,height:34,boxSizing:"border-box",border:function(s){return"1px solid ".concat(s.palette.primary.main)}}}),T&&(0,t.jsx)(Eo.Z,{size:35,sx:{position:"absolute",top:"50%",left:"50%",marginTop:"-17px",marginLeft:"-17px"}})]})}},A=function(s){if(e.pathname!==s.value)if(s.value==="/my"){var S=oo().debounce(function(){c.history.push(s.value),L=[]},200);return L.push(S),console.log(L.length),L.length===2?(oo().map(L,function(H){return H.cancel()}),L=[],D()):S()}else c.history.push(s.value)};return(0,t.jsx)(Lo.Z,{type:["bottom","bottom"],appear:!!(i!=null&&i.boxdata.usercfgs.isAnimate),children:i!=null&&i.boxdata.usercfgs.isHidedNaviBottom?null:(0,t.jsx)(O.Z,{className:u!=null&&u.usercfgs.isTraditionalMenu?U.Z.footer_container_tow:U.Z.footer_container,children:(0,t.jsx)(Po.Z,{className:U.Z.footer_bar,sx:{borderRadius:7,overflow:"hidden",boxShadow:function(s){return"0px 0 3px ".concat(s.palette.primary.main)}},children:(0,t.jsx)(Oo.Z,{showLabels:!0,value:e.pathname,sx:{"& .Mui-selected":{"&:after":{width:.3}}},children:Object.keys(x).map(function(h){var s=x[h];return(0,t.jsx)(zo.Z,{icon:s.icon,value:s.value,onTouchEnd:function(){return A(s)},onClick:function(){return!(i!=null&&i.isMobile)&&A(s)},sx:{"&:after":{content:'""',position:"absolute",height:2,width:0,borderRadius:1,background:function(H){return H.palette.primary.main},top:1,transition:"width 0.3s linear",boxShadow:1}}},h)})})},"paper")})})},Io=Fo,Jo=o(33525),wo=o(47036),Wo=o(39005),ao=o(15861),lo=(0,q.ZP)(O.Z)(function(p){var e=p.theme;return{backgroundColor:e.palette.mode==="light"?"#fff":wo.Z[800]}}),Vo=(0,q.ZP)(O.Z)(function(p){var e=p.theme;return{width:30,height:6,backgroundColor:e.palette.primary.main,borderRadius:3,position:"absolute",top:8,left:"calc(50% - 15px)",boxShadow:e.shadows[1]}}),Qo=function(e){var f;return e.value?(0,t.jsx)("div",{children:(0,t.jsxs)(Wo.Z,{anchor:"bottom",swipeAreaWidth:0,open:e.open||!1,container:function(){return window.document.body},onClose:function(){return e.onClose()},onOpen:function(){return e.onClose()},disableSwipeToOpen:!1,ModalProps:{keepMounted:!0},sx:{zIndex:9999,"& .MuiDrawer-paperAnchorBottom":{maxHeight:"60%",minHeight:"30%",borderTopLeftRadius:8,borderTopRightRadius:8,overflow:"hidden"}},children:[(0,t.jsxs)(lo,{sx:{position:"absolute",top:0,visibility:"visible",right:0,left:0,boxShadow:function(g){return g.shadows[1]}},children:[(0,t.jsx)(Vo,{onClick:function(){return e.onClose()}}),(0,t.jsx)(ao.Z,{sx:{p:2,color:"text.secondary"},children:"\u8FD0\u884C\u7ED3\u679C"})]}),(0,t.jsx)(lo,{sx:{px:2,pb:2,mt:7,overflow:"auto"},children:(0,t.jsx)(ao.Z,{variant:"caption",color:"grey",component:"p",sx:{whiteSpace:"pre-wrap",wordBreak:"break-word",pt:2},children:((f=e.value)===null||f===void 0?void 0:f.output)||JSON.stringify(e.value||"\u6682\u65E0\u7ED3\u679C")})})]})}):null},ko=Qo,Go=o(38281),Ko=o(65582),ro=o(58703),so=o(54776),Uo=o(21737),Xo=o(71415),Yo=o.n(Xo),F={container:"container___MJ5pp",content:"content___FEk3q",container_top:"container_top___QFCHo",my:"my___FfjD2",alert:"alert___K4HMe"},to;function qo(){var p,e,f,i,g,T,B,u,C,D,x,A,h,s,S,H,I,j=(0,c.useLocation)(),m=(0,c.useModel)("alert"),X=(0,c.useModel)("log"),no=(0,c.useModel)("@@initialState"),n=no.initialState,a=(0,c.useModel)("api"),w=a.fetchRunScript,v=a.fetchSave,W=function(){m.alert({})},E=n==null||(p=n.boxdata)===null||p===void 0||(e=p.usercfgs)===null||e===void 0?void 0:e.bgimg,M=n==null||(f=n.boxdata)===null||f===void 0||(i=f.usercfgs)===null||i===void 0||(g=i.bgimgs)===null||g===void 0||(T=g.split(`
`))===null||T===void 0?void 0:T.map(function(r){var b=(r==null?void 0:r.split(","))||[],$=G()(b,2),R=$[0],io=R===void 0?"":R,l=$[1],d=l===void 0?"":l;return{name:io,url:d}});if(E==="\u8DDF\u968F\u7CFB\u7EDF"){var V=M==null?void 0:M.find(function(r){return r.name=="\u6697\u9ED1"||r.name=="dark"}),N=M==null?void 0:M.find(function(r){return r.name=="\u660E\u4EAE"||r.name=="light"}),Y=V?V.url:"",Q=N?N.url:"";(n==null?void 0:n.mode)==="dark"?E=Y:E=Q}return(0,z.useEffect)(function(){var r,b;if(document.oncontextmenu=function(){return!1},n!=null&&(r=n.boxdata)!==null&&r!==void 0&&r.usercfgs.isVConsole)to=new(Yo())({theme:n==null?void 0:n.mode});else if(!(n!=null&&(b=n.boxdata)!==null&&b!==void 0&&b.usercfgs.isVConsole)&&to){var $,R;($=to)===null||$===void 0||(R=$.destroy)===null||R===void 0||R.call($)}n!=null&&n.boxdata.usercfgs.isWallpaperMode&&setTimeout(function(){v.run([{key:J.Z.userCfgs,val:JSON.stringify(y()(y()({},n==null?void 0:n.boxdata.usercfgs),{},{isWallpaperMode:!1}))}])},3e3)},[n==null||(B=n.boxdata)===null||B===void 0?void 0:B.usercfgs.isVConsole,n==null?void 0:n.boxdata.usercfgs.isWallpaperMode]),(0,t.jsxs)(Go.Z,{children:[(0,t.jsxs)(O.Z,{className:n!=null&&(u=n.boxdata)!==null&&u!==void 0&&u.usercfgs.isWaitToggleSearchBar?F.container_top:F.container,children:[!["/my"].includes(j.pathname)&&(0,t.jsx)(Jo.ZP,{}),(0,t.jsx)("div",{draggable:!1,style:{position:"fixed",top:0,left:0,bottom:0,right:0,zIndex:-1,backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundColor:"transparent",backgroundImage:E?"linear-gradient(to bottom,rgba(0,0,0,.2) 0,transparent 76px), url(".concat(E,"?_=").concat(n==null?void 0:n.random,")"):void 0}}),(0,t.jsxs)(Ko.Z,{fixed:!0,maxWidth:!1,className:"".concat(F.content," ").concat(F[j.pathname.replace("/","")]),children:[n!=null&&n.boxdata.usercfgs.isWallpaperMode?null:(0,t.jsx)(c.Outlet,{}),(C=m.options)!==null&&C!==void 0&&C.type?(0,t.jsx)(ro.Z,{className:F.alert,autoHideDuration:2e3,onClose:function(){return W()},open:(D=m.options)===null||D===void 0?void 0:D.open,anchorOrigin:{vertical:"top",horizontal:"left"},TransitionComponent:function(b){return(0,t.jsx)(so.Z,y()(y()({},b),{},{direction:"down"}))},children:(0,t.jsx)(Uo.Z,{sx:{width:"100%"},onClose:function(){return W()},severity:(x=m.options)===null||x===void 0?void 0:x.type,children:(A=m.options)===null||A===void 0?void 0:A.message})},m.options.key):(0,t.jsx)(ro.Z,{className:F.alert,autoHideDuration:1e3,onClose:function(){return W()},open:(h=m.options)===null||h===void 0?void 0:h.open,anchorOrigin:{vertical:"top",horizontal:"left"},TransitionComponent:function(b){return(0,t.jsx)(so.Z,y()(y()({},b),{},{direction:"down"}))},message:(s=m.options)!==null&&s!==void 0&&s.type||(S=m.options)===null||S===void 0?void 0:S.message},m.options.key)]}),(0,t.jsx)(Io,{})]}),(n==null||(H=n.boxdata)===null||H===void 0||(I=H.usercfgs)===null||I===void 0?void 0:I.isHideBoxIcon)!==!0&&(0,t.jsx)(Ho,{}),(0,t.jsx)(ko,{open:X.visible,value:w.data,onClose:function(){return X.setVisible(!1)}})]})}},34747:function(vo,k){k.Z={footer_container:"footer_container___QFPpy",footer_container_tow:"footer_container_tow___BWiJC",footer_bar:"footer_bar___Lok0r"}}}]);
