"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[717],{69360:function(ro,V,o){o.r(V),o.d(V,{default:function(){return ko}});var uo=o(97857),C=o.n(uo),vo=o(5574),Q=o.n(vo),co=o(19632),G=o.n(co),K=o(34747),fo=o(18115),U=o(58291),u=o(22148),xo=o(96214),ho=o(13505),mo=o(43610),po=o(63094),go=o(1849),k=o(90948),So=o(16323),bo=o(90872),Co=o(60265),Zo=o(54128),q=o(69661),jo=o(55137),H=o(87357),yo=o(11984),$o=o(96486),Mo=o.n($o),A=o(67294),t=o(85893),To=(0,k.ZP)(So.Z)(function(h){var e=h.open;return{"& .MuiSpeedDial-actions":{height:e?"unset":"0"}}}),Bo=function(){var e,f,l,g,M,v,S,Z,m,c=(0,A.useRef)(),T=(0,A.useState)(!1),E=Q()(T,2),O=E[0],z=E[1],F=(0,A.useState)(!1),L=Q()(F,2),j=L[0],x=L[1],X=(0,u.useModel)("api"),oo=X.fetchSave,n=(0,u.useModel)("@@initialState"),i=n.initialState,w=i==null?void 0:i.boxdata.syscfgs.boxjs,d=i==null||(e=i.boxdata)===null||e===void 0?void 0:e.usercfgs,I=(0,A.useState)((d==null?void 0:d.actions_position)||{}),N=Q()(I,2),y=N[0],J=N[1],B=i==null||(f=i.ui)===null||f===void 0?void 0:f.call(i,i==null?void 0:i.boxdata),Y=(B==null?void 0:B.iconThemeIdx)!==void 0?B==null?void 0:B.iconThemeIdx:1,W=i==null||(l=i.boxdata)===null||l===void 0||(g=l.syscfgs.envs)===null||g===void 0?void 0:g.find(function(a){var r;return a.id===(i==null||(r=i.boxdata)===null||r===void 0?void 0:r.syscfgs.env)}),s=((M=window)===null||M===void 0?void 0:M.innerWidth)/2,p=(((v=document.getElementsByClassName(fo.Z.header_container))===null||v===void 0||(S=v[0])===null||S===void 0?void 0:S.getBoundingClientRect().height)||160)+30,$=(((Z=document.getElementsByClassName(K.Z.footer_container))===null||Z===void 0||(m=Z[0])===null||m===void 0?void 0:m.getBoundingClientRect().height)||100)+15,R=function(r){var b,no;if(!j&&(r.stopPropagation(),!!c.current)){var so=r.touches[0],D={left:"unset",top:"unset",bottom:"unset",right:"unset"};D.left=so.clientX-((b=c.current)===null||b===void 0?void 0:b.getBoundingClientRect().width)/2,D.bottom=window.innerHeight-(so.clientY+((no=c.current)===null||no===void 0?void 0:no.getBoundingClientRect().height)/2),D.bottom<=$&&(D.bottom=$),D.bottom>=window.innerHeight-p&&(D.bottom=window.innerHeight-p),J(D)}};(0,A.useEffect)(function(){if(!j){var a;(a=c.current)===null||a===void 0||a.addEventListener("touchmove",R,{passive:!1})}return function(){var r;(r=c.current)===null||r===void 0||r.removeEventListener("touchmove",R)}},[j]);var to=[].concat(G()(d!=null&&d.isHideHelp?[]:[{icon:(0,t.jsx)(po.Z,{sx:{color:bo.Z[400]}}),name:"Help",onClick:function(){window.open("https://docs.boxjs.app/")}}]),G()(d!=null&&d.isHideRefresh?[]:[{icon:(0,t.jsx)(go.Z,{sx:{color:Co.Z[400]}}),name:"Refresh",onClick:function(){window.location.reload()}}]),[{icon:(0,t.jsx)(ho.Z,{sx:{color:Zo.Z[400]}}),name:"database",onClick:function(){u.history.push("/database")}}],G()((i==null?void 0:i.boxdata.syscfgs.env)==="Surge"?[{icon:(0,t.jsx)(q.Z,{alt:"BoxJs",src:(W==null?void 0:W.icons[Y])||U.Z.logo,sx:{width:28,height:28,border:1,borderColor:"white"}}),name:"actions",onClick:function(){u.history.push("/actions")}}]:[]),G()(d!=null&&d.isHideCoding?[]:[{icon:(0,t.jsx)(xo.Z,{sx:{color:jo.Z[400]}}),name:"Code",onClick:function(){u.history.push("/code")}}]));return(0,t.jsxs)(t.Fragment,{children:[O&&(0,t.jsx)("div",{style:{position:"fixed",zIndex:98,left:0,top:0,right:0,bottom:0}}),(0,t.jsx)(H.Z,{ref:c,className:"cus-draggable",sx:C()({touchAction:"none",transform:"translateZ(0px)",flexGrow:1,position:"fixed",bottom:100,right:16,zIndex:99},y),component:"div",onTouchStart:function(r){j||(z(!0),r.stopPropagation())},onTouchEnd:function(r){if(z(!1),!j&&(r.stopPropagation(),!Mo().isEqual(y,d==null?void 0:d.actions_position))){var b=C()({},y);Number(b.left)>s?(b.left="unset",b.right=16):(b.left=16,b.right="unset"),J(b),oo.run({key:"@".concat(U.Z.userCfgs,".actions_position"),val:b})}},children:(0,t.jsx)(To,{open:j&&!O,onClose:function(r){x(!1),r.preventDefault()},onClick:function(r){x(!j),r.preventDefault()},FabProps:{size:"medium"},ariaLabel:"SpeedDial controlled open example",icon:(0,t.jsx)(q.Z,{alt:"BoxJS",src:w==null?void 0:w.icons[Y],sx:{width:1,height:1},children:(0,t.jsx)(mo.Z,{color:"error"})}),children:to.map(function(a){return(0,t.jsx)(yo.Z,{icon:a.icon,tooltipTitle:a.name,onClick:a.onClick},a.name)})})})]})},Ro=Bo,No=o(76638),Do=o(81261),Ho=o(78579),Ao=o(98456),Po=o(90629),Eo=o(21528),Oo=o(2359),zo=o(97458),Lo=function(){var e=(0,u.useLocation)(),f=(0,u.useModel)("@@initialState"),l=f.initialState,g=(0,u.useModel)("api"),M=g.loading,v=l==null?void 0:l.boxdata,S=30,Z={"/":{value:"/",icon:(0,t.jsx)(No.Z,{sx:{fontSize:S}})},"/app":{value:"/app",icon:(0,t.jsx)(Ho.Z,{sx:{fontSize:S}})},"/sub":{value:"/sub",icon:(0,t.jsx)(Do.Z,{sx:{fontSize:S}})},"/my":{value:"/my",icon:(0,t.jsxs)(H.Z,{sx:{position:"relative"},children:[(0,t.jsx)(q.Z,{alt:"boxJS",src:(v==null?void 0:v.usercfgs.icon)||U.Z.logo,sx:{width:34,height:34}}),M&&(0,t.jsx)(Ao.Z,{size:34,sx:{position:"absolute",top:"50%",left:"50%",marginTop:"-12px",marginLeft:"-12px"}})]})}};return(0,t.jsx)(zo.Z,{type:["bottom","bottom"],appear:!!(l!=null&&l.boxdata.usercfgs.isAnimate),children:l!=null&&l.boxdata.usercfgs.isHidedNaviBottom?null:(0,t.jsx)(H.Z,{className:v!=null&&v.usercfgs.isTraditionalMenu?K.Z.footer_container_tow:K.Z.footer_container,children:(0,t.jsx)(Po.Z,{className:K.Z.footer_bar,sx:{borderRadius:7,overflow:"hidden",boxShadow:function(c){return"0px 0 3px ".concat(c.palette.primary.main)}},children:(0,t.jsx)(Eo.Z,{showLabels:!0,value:e.pathname,onChange:function(c,T){u.history.push(T)},sx:{"& .Mui-selected":{"&:after":{width:.3}}},children:Object.keys(Z).map(function(m){return(0,t.jsx)(Oo.Z,C()(C()({},Z[m]),{},{sx:{"&:after":{content:'""',position:"absolute",height:2,width:0,borderRadius:1,background:function(T){return T.palette.primary.main},top:1,transition:"width 0.3s linear",boxShadow:1}}}),m)})})},"paper")})})},Fo=Lo,wo=o(33525),Io=o(47036),Jo=o(39005),io=o(15861),eo=(0,k.ZP)(H.Z)(function(h){var e=h.theme;return{backgroundColor:e.palette.mode==="light"?"#fff":Io.Z[800]}}),Wo=(0,k.ZP)(H.Z)(function(h){var e=h.theme;return{width:30,height:6,backgroundColor:e.palette.primary.main,borderRadius:3,position:"absolute",top:8,left:"calc(50% - 15px)",boxShadow:e.shadows[1]}}),Vo=function(e){var f;return e.value?(0,t.jsx)("div",{children:(0,t.jsxs)(Jo.Z,{anchor:"bottom",swipeAreaWidth:0,open:e.open||!1,container:function(){return window.document.body},onClose:function(){return e.onClose()},onOpen:function(){return e.onClose()},disableSwipeToOpen:!1,ModalProps:{keepMounted:!0},sx:{zIndex:9999,"& .MuiDrawer-paperAnchorBottom":{maxHeight:"60%",minHeight:"30%",borderTopLeftRadius:8,borderTopRightRadius:8,overflow:"hidden"}},children:[(0,t.jsxs)(eo,{sx:{position:"absolute",top:0,visibility:"visible",right:0,left:0,boxShadow:function(g){return g.shadows[1]}},children:[(0,t.jsx)(Wo,{onClick:function(){return e.onClose()}}),(0,t.jsx)(io.Z,{sx:{p:2,color:"text.secondary"},children:"\u8FD0\u884C\u7ED3\u679C"})]}),(0,t.jsx)(eo,{sx:{px:2,pb:2,mt:7,overflow:"auto"},children:(0,t.jsx)(io.Z,{variant:"caption",color:"grey",component:"p",sx:{whiteSpace:"pre-wrap",wordBreak:"break-word",pt:2},children:((f=e.value)===null||f===void 0?void 0:f.output)||JSON.stringify(e.value||"\u6682\u65E0\u7ED3\u679C")})})]})}):null},Qo=Vo,Go=o(38281),Ko=o(65582),ao=o(58703),lo=o(54776),Uo=o(21737),Xo=o(71415),Yo=o.n(Xo),P={container:"container___MJ5pp",content:"content___FEk3q",container_top:"container_top___QFCHo",my:"my___FfjD2",alert:"alert___K4HMe"},_;function ko(){var h,e,f,l,g,M,v,S,Z,m,c,T,E,O,z,F,L,j=(0,u.useLocation)(),x=(0,u.useModel)("alert"),X=(0,u.useModel)("log"),oo=(0,u.useModel)("@@initialState"),n=oo.initialState,i=(0,u.useModel)("api"),w=i.fetchRunScript,d=i.fetchSave,I=function(){x.alert({})},N=n==null||(h=n.boxdata)===null||h===void 0||(e=h.usercfgs)===null||e===void 0?void 0:e.bgimg,y=n==null||(f=n.boxdata)===null||f===void 0||(l=f.usercfgs)===null||l===void 0||(g=l.bgimgs)===null||g===void 0||(M=g.split(`
`))===null||M===void 0?void 0:M.map(function(s){var p=(s==null?void 0:s.split(","))||[],$=Q()(p,2),R=$[0],to=R===void 0?"":R,a=$[1],r=a===void 0?"":a;return{name:to,url:r}});if(N==="\u8DDF\u968F\u7CFB\u7EDF"){var J=y==null?void 0:y.find(function(s){return s.name=="\u6697\u9ED1"||s.name=="dark"}),B=y==null?void 0:y.find(function(s){return s.name=="\u660E\u4EAE"||s.name=="light"}),Y=J?J.url:"",W=B?B.url:"";(n==null?void 0:n.mode)==="dark"?N=Y:N=W}return(0,A.useEffect)(function(){var s,p;if(document.oncontextmenu=function(){return!1},n!=null&&(s=n.boxdata)!==null&&s!==void 0&&s.usercfgs.isVConsole)_=new(Yo())({theme:n==null?void 0:n.mode});else if(!(n!=null&&(p=n.boxdata)!==null&&p!==void 0&&p.usercfgs.isVConsole)&&_){var $,R;($=_)===null||$===void 0||(R=$.destroy)===null||R===void 0||R.call($)}n!=null&&n.boxdata.usercfgs.isWallpaperMode&&setTimeout(function(){d.run([{key:U.Z.userCfgs,val:JSON.stringify(C()(C()({},n==null?void 0:n.boxdata.usercfgs),{},{isWallpaperMode:!1}))}])},3e3)},[n==null||(v=n.boxdata)===null||v===void 0?void 0:v.usercfgs.isVConsole,n==null?void 0:n.boxdata.usercfgs.isWallpaperMode]),(0,t.jsxs)(Go.Z,{children:[(0,t.jsxs)(H.Z,{className:n!=null&&(S=n.boxdata)!==null&&S!==void 0&&S.usercfgs.isWaitToggleSearchBar?P.container_top:P.container,children:[!["/my"].includes(j.pathname)&&(0,t.jsx)(wo.ZP,{}),(0,t.jsx)("div",{draggable:!1,style:{position:"fixed",top:0,left:0,bottom:0,right:0,zIndex:-1,backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundColor:"transparent",backgroundImage:N?"linear-gradient(to bottom,rgba(0,0,0,.2) 0,transparent 76px), url(".concat(N,"?_=").concat(n==null?void 0:n.random,")"):void 0}}),(0,t.jsxs)(Ko.Z,{fixed:!0,maxWidth:!1,className:"".concat(P.content," ").concat(P[j.pathname.replace("/","")]),children:[n!=null&&n.boxdata.usercfgs.isWallpaperMode?null:(0,t.jsx)(u.Outlet,{}),(Z=x.options)!==null&&Z!==void 0&&Z.type?(0,t.jsx)(ao.Z,{className:P.alert,autoHideDuration:2e3,onClose:function(){return I()},open:(m=x.options)===null||m===void 0?void 0:m.open,anchorOrigin:{vertical:"top",horizontal:"left"},TransitionComponent:function(p){return(0,t.jsx)(lo.Z,C()(C()({},p),{},{direction:"down"}))},children:(0,t.jsx)(Uo.Z,{sx:{width:"100%"},onClose:function(){return I()},severity:(c=x.options)===null||c===void 0?void 0:c.type,children:(T=x.options)===null||T===void 0?void 0:T.message})},x.options.key):(0,t.jsx)(ao.Z,{className:P.alert,autoHideDuration:1e3,onClose:function(){return I()},open:(E=x.options)===null||E===void 0?void 0:E.open,anchorOrigin:{vertical:"top",horizontal:"left"},TransitionComponent:function(p){return(0,t.jsx)(lo.Z,C()(C()({},p),{},{direction:"down"}))},message:(O=x.options)!==null&&O!==void 0&&O.type||(z=x.options)===null||z===void 0?void 0:z.message},x.options.key)]}),(0,t.jsx)(Fo,{})]}),(n==null||(F=n.boxdata)===null||F===void 0||(L=F.usercfgs)===null||L===void 0?void 0:L.isHideBoxIcon)!==!0&&(0,t.jsx)(Ro,{}),(0,t.jsx)(Qo,{open:X.visible,value:w.data,onClose:function(){return X.setVisible(!1)}})]})}},34747:function(ro,V){V.Z={footer_container:"footer_container___QFPpy",footer_container_tow:"footer_container_tow___BWiJC",footer_bar:"footer_bar___Lok0r"}}}]);
