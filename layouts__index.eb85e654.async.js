"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[717],{69360:function(vo,G,o){o.r(G),o.d(G,{default:function(){return qo}});var co=o(97857),Z=o.n(co),fo=o(5574),K=o.n(fo),xo=o(19632),U=o.n(xo),X=o(34747),ho=o(18115),I=o(58291),c=o(22148),po=o(96214),mo=o(13505),go=o(43610),So=o(63094),bo=o(1849),q=o(90948),Co=o(16323),Zo=o(90872),yo=o(60265),jo=o(54128),_=o(69661),$o=o(55137),z=o(87357),Mo=o(11984),To=o(96486),oo=o.n(To),L=o(67294),t=o(85893),Bo=(0,q.ZP)(Co.Z)(function(p){var i=p.open;return{"& .MuiSpeedDial-actions":{height:i?"unset":"0"}}}),Do=function(){var i,f,e,m,T,B,d,S,D,x=(0,L.useRef)(),b=(0,L.useState)(!1),u=K()(b,2),R=u[0],y=u[1],A=(0,L.useState)(!1),P=K()(A,2),j=P[0],h=P[1],Y=(0,c.useModel)("api"),no=Y.fetchSave,n=(0,c.useModel)("@@initialState"),a=n.initialState,w=a==null?void 0:a.boxdata.syscfgs.boxjs,v=a==null||(i=a.boxdata)===null||i===void 0?void 0:i.usercfgs,W=(0,L.useState)((v==null?void 0:v.actions_position)||{}),O=K()(W,2),$=O[0],V=O[1],H=a==null||(f=a.ui)===null||f===void 0?void 0:f.call(a,a==null?void 0:a.boxdata),k=(H==null?void 0:H.iconThemeIdx)!==void 0?H==null?void 0:H.iconThemeIdx:1,Q=a==null||(e=a.boxdata)===null||e===void 0||(m=e.syscfgs.envs)===null||m===void 0?void 0:m.find(function(l){var s;return l.id===(a==null||(s=a.boxdata)===null||s===void 0?void 0:s.syscfgs.env)}),r=((T=window)===null||T===void 0?void 0:T.innerWidth)/2,g=(((B=document.getElementsByClassName(ho.Z.header_container))===null||B===void 0||(d=B[0])===null||d===void 0?void 0:d.getBoundingClientRect().height)||160)+30,M=(((S=document.getElementsByClassName(X.Z.footer_container))===null||S===void 0||(D=S[0])===null||D===void 0?void 0:D.getBoundingClientRect().height)||100)+15,N=function(s){var C,eo;if(!j&&(s.stopPropagation(),!!x.current)){var uo=s.touches[0],E={left:"unset",top:"unset",bottom:"unset",right:"unset"};E.left=uo.clientX-((C=x.current)===null||C===void 0?void 0:C.getBoundingClientRect().width)/2,E.bottom=window.innerHeight-(uo.clientY+((eo=x.current)===null||eo===void 0?void 0:eo.getBoundingClientRect().height)/2),E.bottom<=M&&(E.bottom=M),E.bottom>=window.innerHeight-g&&(E.bottom=window.innerHeight-g),V(E)}};(0,L.useEffect)(function(){if(!j){var l;(l=x.current)===null||l===void 0||l.addEventListener("touchmove",N,{passive:!1})}return function(){var s;(s=x.current)===null||s===void 0||s.removeEventListener("touchmove",N)}},[j]);var io=[].concat(U()(v!=null&&v.isHideHelp?[]:[{icon:(0,t.jsx)(So.Z,{sx:{color:Zo.Z[400]}}),name:"Help",onClick:function(){window.open("https://docs.boxjs.app/")}}]),U()(v!=null&&v.isHideRefresh?[]:[{icon:(0,t.jsx)(bo.Z,{sx:{color:yo.Z[400]}}),name:"Refresh",onClick:function(){window.location.reload()}}]),[{icon:(0,t.jsx)(mo.Z,{sx:{color:jo.Z[400]}}),name:"database",onClick:function(){c.history.push("/database")}}],U()((a==null?void 0:a.boxdata.syscfgs.env)==="Surge"?[{icon:(0,t.jsx)(_.Z,{alt:"BoxJs",src:(Q==null?void 0:Q.icons[k])||I.Z.logo,sx:{width:28,height:28,border:1,borderColor:"white"}}),name:"actions",onClick:function(){c.history.push("/actions")}}]:[]),U()(v!=null&&v.isHideCoding?[]:[{icon:(0,t.jsx)(po.Z,{sx:{color:$o.Z[400]}}),name:"Code",onClick:function(){c.history.push("/code")}}]));return(0,t.jsxs)(t.Fragment,{children:[R&&(0,t.jsx)("div",{style:{position:"fixed",zIndex:98,left:0,top:0,right:0,bottom:0}}),(0,t.jsx)(z.Z,{ref:x,className:"cus-draggable",sx:Z()({touchAction:"none",transform:"translateZ(0px)",flexGrow:1,position:"fixed",bottom:100,right:16,zIndex:99},$),component:"div",onTouchStart:function(s){j||(y(!0),s.stopPropagation())},onTouchEnd:function(s){if(y(!1),!j&&(s.stopPropagation(),!oo().isEqual($,v==null?void 0:v.actions_position))){var C=Z()({},$);Number(C.left)>r?(C.left="unset",C.right=16):(C.left=16,C.right="unset"),V(C),no.run({key:"@".concat(I.Z.userCfgs,".actions_position"),val:C})}},children:(0,t.jsx)(Bo,{open:j&&!R,onClose:function(s){h(!1),s.preventDefault()},onClick:function(s){h(!j),s.preventDefault()},FabProps:{size:"medium"},ariaLabel:"SpeedDial controlled open example",icon:(0,t.jsx)(_.Z,{alt:"BoxJS",src:w==null?void 0:w.icons[k],sx:{width:1,height:1},children:(0,t.jsx)(go.Z,{color:"error"})}),children:io.map(function(l){return(0,t.jsx)(Mo.Z,{icon:l.icon,tooltipTitle:l.name,onClick:l.onClick},l.name)})})})]})},Ho=Do,No=o(76638),Ro=o(81261),Ao=o(78579),Po=o(98456),Oo=o(90629),Eo=o(21528),zo=o(2359),Lo=o(97458),J=[],Fo=function(){var i=(0,c.useLocation)(),f=(0,c.useModel)("@@initialState"),e=f.initialState,m=(0,c.useModel)("api"),T=m.loading,B=m.fetchSave,d=e==null?void 0:e.boxdata,S=30,D=function(){B.run([{key:I.Z.userCfgs,val:JSON.stringify(Z()(Z()({},e==null?void 0:e.boxdata.usercfgs),{},{isHideBoxIcon:!(d!=null&&d.usercfgs.isHideBoxIcon)}))}])},x={"/home":{value:"/home",icon:(0,t.jsx)(No.Z,{sx:{fontSize:S}})},"/app":{value:"/app",icon:(0,t.jsx)(Ao.Z,{sx:{fontSize:S}})},"/sub":{value:"/sub",icon:(0,t.jsx)(Ro.Z,{sx:{fontSize:S}})},"/my":{value:"/my",icon:(0,t.jsxs)(z.Z,{sx:{position:"relative"},children:[(0,t.jsx)(_.Z,{alt:"boxJS",src:(d==null?void 0:d.usercfgs.icon)||I.Z.logo,sx:{width:34,height:34,boxSizing:"border-box",border:function(u){return"1px solid ".concat(u.palette.primary.main)}}}),T&&(0,t.jsx)(Po.Z,{size:35,sx:{position:"absolute",top:"50%",left:"50%",marginTop:"-17px",marginLeft:"-17px"}})]})}};return(0,t.jsx)(Lo.Z,{type:["bottom","bottom"],appear:!!(e!=null&&e.boxdata.usercfgs.isAnimate),children:e!=null&&e.boxdata.usercfgs.isHidedNaviBottom?null:(0,t.jsx)(z.Z,{className:d!=null&&d.usercfgs.isTraditionalMenu?X.Z.footer_container_tow:X.Z.footer_container,children:(0,t.jsx)(Oo.Z,{className:X.Z.footer_bar,sx:{borderRadius:7,overflow:"hidden",boxShadow:function(u){return"0px 0 3px ".concat(u.palette.primary.main)}},children:(0,t.jsx)(Eo.Z,{showLabels:!0,value:i.pathname,sx:{"& .Mui-selected":{"&:after":{width:.3}}},children:Object.keys(x).map(function(b){var u=x[b];return(0,t.jsx)(zo.Z,{value:u.value,icon:u.icon,onClick:function(y){if(i.pathname!==u.value){if(u.value==="/my"){var A=oo().debounce(function(){c.history.push(u.value),J=[]},200);if(J.push(A),J.length>1)return oo().map(J,function(P){return P.cancel()}),J=[],D();A()}else c.history.push(u.value);y.preventDefault()}},sx:{"&:after":{content:'""',position:"absolute",height:2,width:0,borderRadius:1,background:function(y){return y.palette.primary.main},top:1,transition:"width 0.3s linear",boxShadow:1}}},b)})})},"paper")})})},Io=Fo,Jo=o(33525),wo=o(47036),Wo=o(39005),ao=o(15861),lo=(0,q.ZP)(z.Z)(function(p){var i=p.theme;return{backgroundColor:i.palette.mode==="light"?"#fff":wo.Z[800]}}),Vo=(0,q.ZP)(z.Z)(function(p){var i=p.theme;return{width:30,height:6,backgroundColor:i.palette.primary.main,borderRadius:3,position:"absolute",top:8,left:"calc(50% - 15px)",boxShadow:i.shadows[1]}}),Qo=function(i){var f;return i.value?(0,t.jsx)("div",{children:(0,t.jsxs)(Wo.Z,{anchor:"bottom",swipeAreaWidth:0,open:i.open||!1,container:function(){return window.document.body},onClose:function(){return i.onClose()},onOpen:function(){return i.onClose()},disableSwipeToOpen:!1,ModalProps:{keepMounted:!0},sx:{zIndex:9999,"& .MuiDrawer-paperAnchorBottom":{maxHeight:"60%",minHeight:"30%",borderTopLeftRadius:8,borderTopRightRadius:8,overflow:"hidden"}},children:[(0,t.jsxs)(lo,{sx:{position:"absolute",top:0,visibility:"visible",right:0,left:0,boxShadow:function(m){return m.shadows[1]}},children:[(0,t.jsx)(Vo,{onClick:function(){return i.onClose()}}),(0,t.jsx)(ao.Z,{sx:{p:2,color:"text.secondary"},children:"\u8FD0\u884C\u7ED3\u679C"})]}),(0,t.jsx)(lo,{sx:{px:2,pb:2,mt:7,overflow:"auto"},children:(0,t.jsx)(ao.Z,{variant:"caption",color:"grey",component:"p",sx:{whiteSpace:"pre-wrap",wordBreak:"break-word",pt:2},children:((f=i.value)===null||f===void 0?void 0:f.output)||JSON.stringify(i.value||"\u6682\u65E0\u7ED3\u679C")})})]})}):null},Go=Qo,Ko=o(38281),Uo=o(65582),ro=o(58703),so=o(54776),Xo=o(21737),Yo=o(71415),ko=o.n(Yo),F={container:"container___MJ5pp",content:"content___FEk3q",container_top:"container_top___QFCHo",my:"my___FfjD2",alert:"alert___K4HMe"},to;function qo(){var p,i,f,e,m,T,B,d,S,D,x,b,u,R,y,A,P,j=(0,c.useLocation)(),h=(0,c.useModel)("alert"),Y=(0,c.useModel)("log"),no=(0,c.useModel)("@@initialState"),n=no.initialState,a=(0,c.useModel)("api"),w=a.fetchRunScript,v=a.fetchSave,W=function(){h.alert({})},O=n==null||(p=n.boxdata)===null||p===void 0||(i=p.usercfgs)===null||i===void 0?void 0:i.bgimg,$=n==null||(f=n.boxdata)===null||f===void 0||(e=f.usercfgs)===null||e===void 0||(m=e.bgimgs)===null||m===void 0||(T=m.split(`
`))===null||T===void 0?void 0:T.map(function(r){var g=(r==null?void 0:r.split(","))||[],M=K()(g,2),N=M[0],io=N===void 0?"":N,l=M[1],s=l===void 0?"":l;return{name:io,url:s}});if(O==="\u8DDF\u968F\u7CFB\u7EDF"){var V=$==null?void 0:$.find(function(r){return r.name=="\u6697\u9ED1"||r.name=="dark"}),H=$==null?void 0:$.find(function(r){return r.name=="\u660E\u4EAE"||r.name=="light"}),k=V?V.url:"",Q=H?H.url:"";(n==null?void 0:n.mode)==="dark"?O=k:O=Q}return(0,L.useEffect)(function(){var r,g;if(document.oncontextmenu=function(){return!1},n!=null&&(r=n.boxdata)!==null&&r!==void 0&&r.usercfgs.isVConsole)to=new(ko())({theme:n==null?void 0:n.mode});else if(!(n!=null&&(g=n.boxdata)!==null&&g!==void 0&&g.usercfgs.isVConsole)&&to){var M,N;(M=to)===null||M===void 0||(N=M.destroy)===null||N===void 0||N.call(M)}n!=null&&n.boxdata.usercfgs.isWallpaperMode&&setTimeout(function(){v.run([{key:I.Z.userCfgs,val:JSON.stringify(Z()(Z()({},n==null?void 0:n.boxdata.usercfgs),{},{isWallpaperMode:!1}))}])},3e3)},[n==null||(B=n.boxdata)===null||B===void 0?void 0:B.usercfgs.isVConsole,n==null?void 0:n.boxdata.usercfgs.isWallpaperMode]),(0,t.jsxs)(Ko.Z,{children:[(0,t.jsxs)(z.Z,{className:n!=null&&(d=n.boxdata)!==null&&d!==void 0&&d.usercfgs.isWaitToggleSearchBar?F.container_top:F.container,children:[!["/my"].includes(j.pathname)&&(0,t.jsx)(Jo.ZP,{}),(0,t.jsx)("div",{draggable:!1,style:{position:"fixed",top:0,left:0,bottom:0,right:0,zIndex:-1,backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundColor:"transparent",backgroundImage:O?"linear-gradient(to bottom,rgba(0,0,0,.2) 0,transparent 76px), url(".concat(O,"?_=").concat(n==null?void 0:n.random,")"):void 0}}),(0,t.jsxs)(Uo.Z,{fixed:!0,maxWidth:!1,className:"".concat(F.content," ").concat(F[j.pathname.replace("/","")]),children:[n!=null&&n.boxdata.usercfgs.isWallpaperMode?null:(0,t.jsx)(c.Outlet,{}),(S=h.options)!==null&&S!==void 0&&S.type?(0,t.jsx)(ro.Z,{className:F.alert,autoHideDuration:2e3,onClose:function(){return W()},open:(D=h.options)===null||D===void 0?void 0:D.open,anchorOrigin:{vertical:"top",horizontal:"left"},TransitionComponent:function(g){return(0,t.jsx)(so.Z,Z()(Z()({},g),{},{direction:"down"}))},children:(0,t.jsx)(Xo.Z,{sx:{width:"100%"},onClose:function(){return W()},severity:(x=h.options)===null||x===void 0?void 0:x.type,children:(b=h.options)===null||b===void 0?void 0:b.message})},h.options.key):(0,t.jsx)(ro.Z,{className:F.alert,autoHideDuration:1e3,onClose:function(){return W()},open:(u=h.options)===null||u===void 0?void 0:u.open,anchorOrigin:{vertical:"top",horizontal:"left"},TransitionComponent:function(g){return(0,t.jsx)(so.Z,Z()(Z()({},g),{},{direction:"down"}))},message:(R=h.options)!==null&&R!==void 0&&R.type||(y=h.options)===null||y===void 0?void 0:y.message},h.options.key)]}),(0,t.jsx)(Io,{})]}),(n==null||(A=n.boxdata)===null||A===void 0||(P=A.usercfgs)===null||P===void 0?void 0:P.isHideBoxIcon)!==!0&&(0,t.jsx)(Ho,{}),(0,t.jsx)(Go,{open:Y.visible,value:w.data,onClose:function(){return Y.setVisible(!1)}})]})}},34747:function(vo,G){G.Z={footer_container:"footer_container___QFPpy",footer_container_tow:"footer_container_tow___BWiJC",footer_bar:"footer_bar___Lok0r"}}}]);
